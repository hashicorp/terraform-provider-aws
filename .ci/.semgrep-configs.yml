# Generated by internal/generate/servicesemgrep/main.go; DO NOT EDIT.
rules:
  - id: test-config-funcs-correct-form
    languages:
      - go
    message: "Config funcs should follow form testAcc<Resource>Config_<testDetail>"
    paths:
      include:
        - "/internal/service/**/*_test.go"
    patterns:
      - pattern-inside: "[]resource.TestStep{ ... }"
      - pattern: "{..., $KEY:$VALUE, ...}"
      - metavariable-pattern:
          metavariable: "$KEY"
          patterns:
            - pattern: "Config"
      - metavariable-pattern:
          metavariable: "$VALUE"
          patterns:
            - pattern-not-regex: "testAcc[0-9A-Za-z]+Config(_[0-9A-Za-z_]+_|_)[0-9a-z].*"
            - pattern-not: acctest.ConfigCompose(...)
            - pattern-not: "..."
    severity: WARNING

  - id: test-configcompose-funcs-correct-form
    languages:
      - go
    message: "Config funcs should follow form testAcc<Resource>Config_<testDetail>"
    paths:
      include:
        - "/internal/service/**/*_test.go"
    patterns:
      - pattern-inside: "[]resource.TestStep{ ... }"
      - pattern: "{..., $KEY: acctest.ConfigCompose(..., $VALUE, ...), ...}"
      - metavariable-pattern:
          metavariable: "$KEY"
          patterns:
            - pattern: "Config"
      - metavariable-pattern:
          metavariable: "$VALUE"
          patterns:
            - pattern-not-regex: "testAcc[0-9A-Za-z]+Config(_[0-9A-Za-z_]+_|_)[0-9a-z].*"
            - pattern-not-regex: "acctest\\..*"
    severity: WARNING

  - id: test-config-funcs-check
    languages:
      - go
    message: "Config funcs should not begin with 'testAccCheck'"
    paths:
      include:
        - "/internal/service/**/*_test.go"
    patterns:
      - pattern-inside: "[]resource.TestStep{ ... }"
      - pattern: "{..., $KEY:$VALUE, ...}"
      - metavariable-pattern:
          metavariable: "$KEY"
          patterns:
            - pattern: "Config"
      - metavariable-pattern:
          metavariable: "$VALUE"
          patterns:
            - pattern-regex: "testAccCheck.*"
    severity: WARNING

  - id: test-configcompose-funcs-check
    languages:
      - go
    message: "Config funcs should not begin with 'testAccCheck'"
    paths:
      include:
        - "/internal/service/**/*_test.go"
    patterns:
      - pattern-inside: "[]resource.TestStep{ ... }"
      - pattern: "{..., $KEY: acctest.ConfigCompose(..., $VALUE, ...), ...}"
      - metavariable-pattern:
          metavariable: "$KEY"
          patterns:
            - pattern: "Config"
      - metavariable-pattern:
          metavariable: "$VALUE"
          patterns:
            - pattern-regex: "testAccCheck.*"
    severity: WARNING
