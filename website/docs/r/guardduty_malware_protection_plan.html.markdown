---
subcategory: "GuardDuty"
layout: "aws"
page_title: "AWS: aws_guardduty_malware_protection_plan"
description: |-
  Provides a resource to manage a GuardDuty Malware Protection Plan
---

# Resource: aws_guardduty_malware_protection_plan

Provides a resource to manage a GuardDuty malware protection plan.

## Example Usage

```terraform
resource "aws_guardduty_malware_protection_plan" "example" {
  role = aws_iam_role.example.arn

  protected_resource {
    s3_bucket {
      bucket_name     = aws_s3_bucket.example.id
      object_prefixes = ["example1", "example2"]
    }
  }

  actions {
    tagging {
      status = "ENABLED"
    }
  }

  tags = {
    "Name" = "example"
  }
}
```

## Argument Reference

This resource supports the following arguments:

* `actions` - (Optional) Information about whether the tags will be added to the S3 object after scanning. See [`actions`](#actions-argument-reference) below.
* `protected_resource` - (Required) Information about the protected resource that is associated with the created Malware Protection plan. Presently, S3Bucket is the only supported protected resource. See [`protected_resource`](#protected_resource-argument-reference) below.
* `role` - (Required) The IAM role that includes the permissions required to scan and add tags to the associated protected resource.
* `tags` - (Optional) Key-value mapping of resource tags. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.

### `actions` argument reference

* `tagging` - (Required) Indicates whether the scanned S3 object will have tags about the scan result. See [`tagging`](#tagging-argument-reference) below.

#### `tagging` argument reference

* `status` - (Required) Indicates whether or not the tags will added. Valid values are `DISABLED` and `ENABLED`. Defaults to `DISABLED`

### `protected_resource` argument reference

* `s3_bucket` - (Required) Information about the protected S3 bucket resource. See [`s3_bucket`](#s3_bucket-argument-reference) below.

#### `s3_bucket` argument reference

* `bucket_name` - (Required, Forces new resource) Name of the S3 bucket.
* `object_prefixes` - (Optional) The list of object prefixes that specify the S3 objects that will be scanned.

## Attribute Reference

This resource exports the following attributes in addition to the arguments above:

* `arn` - The ARN of the GuardDuty malware protection plan
* `created_at` - The timestamp when the Malware Protection plan resource was created.
* `id` - The ID of the GuardDuty malware protection plan
* `status` - The GuardDuty malware protection plan status. Valid values are `ACTIVE`, `WARNING`, and `ERROR`.

## Import

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import GuardDuty malware protection plans using their IDs. For example:

```terraform
import {
  to = aws_guardduty_malware_protection_plan.example
  id = "1234567890abcdef0123"
}
```

Using `terraform import`, import GuardDuty malware protection plans using their IDs. For example:

```console
% terraform import aws_guardduty_malware_protection_plan.example 1234567890abcdef0123
```
