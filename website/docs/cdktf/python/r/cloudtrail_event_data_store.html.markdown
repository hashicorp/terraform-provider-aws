---
subcategory: "CloudTrail"
layout: "aws"
page_title: "AWS: aws_cloudtrail_event_data_store"
description: |-
  Provides a CloudTrail Event Data Store resource.
---


<!-- Please do not edit this file, it is generated. -->
# Resource: aws_cloudtrail_event_data_store

Provides a CloudTrail Event Data Store.

More information about event data stores can be found in the [Event Data Store User Guide](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-event-data-store.html).

-> **Tip:** For an organization event data store you must create this resource in the management account.

## Example Usage

### Basic

The most simple event data store configuration requires us to only set the `name` attribute. The event data store will automatically capture all management events. To capture management events from all the regions, `multi_region_enabled` must be `true`.

```python
# DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
from constructs import Construct
from cdktf import TerraformStack
#
# Provider bindings are generated by running `cdktf get`.
# See https://cdk.tf/provider-generation for more details.
#
from imports.aws.cloudtrail_event_data_store import CloudtrailEventDataStore
class MyConvertedCode(TerraformStack):
    def __init__(self, scope, name):
        super().__init__(scope, name)
        CloudtrailEventDataStore(self, "example",
            name="example-event-data-store"
        )
```

### Data Event Logging

CloudTrail can log [Data Events](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-data-events-with-cloudtrail.html) for certain services such as S3 bucket objects and Lambda function invocations. Additional information about data event configuration can be found in the following links:

- [CloudTrail API AdvancedFieldSelector documentation](https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_AdvancedFieldSelector.html)

#### Log all DynamoDB PutEvent actions for a specific DynamoDB table

```python
# DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
from constructs import Construct
from cdktf import Token, TerraformStack
#
# Provider bindings are generated by running `cdktf get`.
# See https://cdk.tf/provider-generation for more details.
#
from imports.aws.cloudtrail_event_data_store import CloudtrailEventDataStore
from imports.aws.data_aws_dynamodb_table import DataAwsDynamodbTable
class MyConvertedCode(TerraformStack):
    def __init__(self, scope, name, *, name):
        super().__init__(scope, name)
        table = DataAwsDynamodbTable(self, "table",
            name="not-important-dynamodb-table"
        )
        CloudtrailEventDataStore(self, "example",
            advanced_event_selector=[CloudtrailEventDataStoreAdvancedEventSelector(
                field_selector=[CloudtrailEventDataStoreAdvancedEventSelectorFieldSelector(
                    equal_to=["Data"],
                    field="eventCategory"
                ), CloudtrailEventDataStoreAdvancedEventSelectorFieldSelector(
                    equal_to=["AWS::DynamoDB::Table"],
                    field="resources.type"
                ), CloudtrailEventDataStoreAdvancedEventSelectorFieldSelector(
                    equal_to=["PutItem"],
                    field="eventName"
                ), CloudtrailEventDataStoreAdvancedEventSelectorFieldSelector(
                    equal_to=[Token.as_string(table.arn)],
                    field="resources.ARN"
                )
                ],
                name="Log all DynamoDB PutEvent actions for a specific DynamoDB table"
            )
            ],
            name=name
        )
```

## Argument Reference

This resource supports the following arguments:

- `name` - (Required) The name of the event data store.
- `billing_mode` - (Optional) The billing mode for the event data store. The valid values are `EXTENDABLE_RETENTION_PRICING` and `FIXED_RETENTION_PRICING`. Defaults to `EXTENDABLE_RETENTION_PRICING`.
- `advanced_event_selector` - (Optional) The advanced event selectors to use to select the events for the data store. For more information about how to use advanced event selectors, see [Log events by using advanced event selectors](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-data-events-with-cloudtrail.html#creating-data-event-selectors-advanced) in the CloudTrail User Guide.
- `multi_region_enabled` - (Optional) Specifies whether the event data store includes events from all regions, or only from the region in which the event data store is created. Default: `true`.
- `organization_enabled` - (Optional) Specifies whether an event data store collects events logged for an organization in AWS Organizations. Default: `false`.
- `retention_period` - (Optional) The retention period of the event data store, in days. You can set a retention period of up to 2555 days, the equivalent of seven years. Default: `2555`.
- `kms_key_id` - Specifies the AWS KMS key ID to use to encrypt the events delivered by CloudTrail. The value can be an alias name prefixed by alias/, a fully specified ARN to an alias, a fully specified ARN to a key, or a globally unique identifier.
- `tags` - (Optional) A map of tags to assign to the resource. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.
- `termination_protection_enabled` - (Optional) Specifies whether termination protection is enabled for the event data store. If termination protection is enabled, you cannot delete the event data store until termination protection is disabled. Default: `true`.

### Advanced Event Selector Arguments

`advanced_event_selector` supports the following arguments:

- `name` (Optional) - Specifies the name of the advanced event selector.
- `field_selector` (Required) - Specifies the selector statements in an advanced event selector. Fields documented below.

#### Field Selector Arguments

`field_selector` supports the following arguments:

- `field` (Required) - Specifies a field in an event record on which to filter events to be logged. You can specify only the following values: `readOnly`, `eventSource`, `eventName`, `eventCategory`, `resources.type`, `resources.ARN`.
- `equals` (Optional) - A list of values that includes events that match the exact value of the event record field specified as the value of `field`. This is the only valid operator that you can use with the `readOnly`, `eventCategory`, and `resources.type` fields.
- `not_equals` (Optional) - A list of values that excludes events that match the exact value of the event record field specified as the value of `field`.
- `starts_with` (Optional) - A list of values that includes events that match the first few characters of the event record field specified as the value of `field`.
- `not_starts_with` (Optional) - A list of values that excludes events that match the first few characters of the event record field specified as the value of `field`.
- `ends_with` (Optional) - A list of values that includes events that match the last few characters of the event record field specified as the value of `field`.
- `not_ends_with` (Optional) - A list of values that excludes events that match the last few characters of the event record field specified as the value of `field`.

## Attribute Reference

This resource exports the following attributes in addition to the arguments above:

- `arn` - ARN of the event data store.
- `id` - Name of the event data store.
- `tags_all` - Map of tags assigned to the resource, including those inherited from the provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).

## Import

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import event data stores using their `arn`. For example:

```python
# DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
from constructs import Construct
from cdktf import TerraformStack
#
# Provider bindings are generated by running `cdktf get`.
# See https://cdk.tf/provider-generation for more details.
#
from imports.aws.cloudtrail_event_data_store import CloudtrailEventDataStore
class MyConvertedCode(TerraformStack):
    def __init__(self, scope, name):
        super().__init__(scope, name)
        CloudtrailEventDataStore.generate_config_for_import(self, "example", "arn:aws:cloudtrail:us-east-1:123456789123:eventdatastore/22333815-4414-412c-b155-dd254033gfhf")
```

Using `terraform import`, import event data stores using their `arn`. For example:

```console
% terraform import aws_cloudtrail_event_data_store.example arn:aws:cloudtrail:us-east-1:123456789123:eventdatastore/22333815-4414-412c-b155-dd254033gfhf
```

<!-- cache-key: cdktf-0.20.1 input-f4bc0565488d90b66ae4b82d9b0723130fb534182f7ac4095a746f7571dd2922 -->