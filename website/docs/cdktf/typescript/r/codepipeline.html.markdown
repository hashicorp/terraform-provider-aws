---
subcategory: "CodePipeline"
layout: "aws"
page_title: "AWS: aws_codepipeline"
description: |-
  Provides a CodePipeline
---


<!-- Please do not edit this file, it is generated. -->
# Resource: aws_codepipeline

Provides a CodePipeline.

## Example Usage

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Codepipeline } from "./.gen/providers/aws/codepipeline";
import { CodestarconnectionsConnection } from "./.gen/providers/aws/codestarconnections-connection";
import { DataAwsIamPolicyDocument } from "./.gen/providers/aws/data-aws-iam-policy-document";
import { DataAwsKmsAlias } from "./.gen/providers/aws/data-aws-kms-alias";
import { IamRole } from "./.gen/providers/aws/iam-role";
import { IamRolePolicy } from "./.gen/providers/aws/iam-role-policy";
import { S3Bucket } from "./.gen/providers/aws/s3-bucket";
import { S3BucketAcl } from "./.gen/providers/aws/s3-bucket-acl";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const example = new CodestarconnectionsConnection(this, "example", {
      name: "example-connection",
      providerType: "GitHub",
    });
    const codepipelineBucket = new S3Bucket(this, "codepipeline_bucket", {
      bucket: "test-bucket",
    });
    new S3BucketAcl(this, "codepipeline_bucket_acl", {
      acl: "private",
      bucket: codepipelineBucket.id,
    });
    const assumeRole = new DataAwsIamPolicyDocument(this, "assume_role", {
      statement: [
        {
          actions: ["sts:AssumeRole"],
          effect: "Allow",
          principals: [
            {
              identifiers: ["codepipeline.amazonaws.com"],
              type: "Service",
            },
          ],
        },
      ],
    });
    const codepipelinePolicy = new DataAwsIamPolicyDocument(
      this,
      "codepipeline_policy",
      {
        statement: [
          {
            actions: [
              "s3:GetObject",
              "s3:GetObjectVersion",
              "s3:GetBucketVersioning",
              "s3:PutObjectAcl",
              "s3:PutObject",
            ],
            effect: "Allow",
            resources: [
              codepipelineBucket.arn,
              "${" + codepipelineBucket.arn + "}/*",
            ],
          },
          {
            actions: ["codestar-connections:UseConnection"],
            effect: "Allow",
            resources: [example.arn],
          },
          {
            actions: ["codebuild:BatchGetBuilds", "codebuild:StartBuild"],
            effect: "Allow",
            resources: ["*"],
          },
        ],
      }
    );
    const s3Kmskey = new DataAwsKmsAlias(this, "s3kmskey", {
      name: "alias/myKmsKey",
    });
    const codepipelineRole = new IamRole(this, "codepipeline_role", {
      assumeRolePolicy: Token.asString(assumeRole.json),
      name: "test-role",
    });
    const awsIamRolePolicyCodepipelinePolicy = new IamRolePolicy(
      this,
      "codepipeline_policy_7",
      {
        name: "codepipeline_policy",
        policy: Token.asString(codepipelinePolicy.json),
        role: codepipelineRole.id,
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsIamRolePolicyCodepipelinePolicy.overrideLogicalId("codepipeline_policy");
    new Codepipeline(this, "codepipeline", {
      artifactStore: [
        {
          encryptionKey: {
            id: Token.asString(s3Kmskey.arn),
            type: "KMS",
          },
          location: codepipelineBucket.bucket,
          type: "S3",
        },
      ],
      name: "tf-test-pipeline",
      roleArn: codepipelineRole.arn,
      stage: [
        {
          action: [
            {
              category: "Source",
              configuration: {
                BranchName: "main",
                ConnectionArn: example.arn,
                FullRepositoryId: "my-organization/example",
              },
              name: "Source",
              outputArtifacts: ["source_output"],
              owner: "AWS",
              provider: "CodeStarSourceConnection",
              version: "1",
            },
          ],
          name: "Source",
        },
        {
          action: [
            {
              category: "Build",
              configuration: {
                ProjectName: "test",
              },
              inputArtifacts: ["source_output"],
              name: "Build",
              outputArtifacts: ["build_output"],
              owner: "AWS",
              provider: "CodeBuild",
              version: "1",
            },
          ],
          name: "Build",
        },
        {
          action: [
            {
              category: "Deploy",
              configuration: {
                ActionMode: "REPLACE_ON_FAILURE",
                Capabilities: "CAPABILITY_AUTO_EXPAND,CAPABILITY_IAM",
                OutputFileName: "CreateStackOutput.json",
                StackName: "MyStack",
                TemplatePath: "build_output::sam-templated.yaml",
              },
              inputArtifacts: ["build_output"],
              name: "Deploy",
              owner: "AWS",
              provider: "CloudFormation",
              version: "1",
            },
          ],
          name: "Deploy",
        },
      ],
    });
  }
}

```

## Argument Reference

This resource supports the following arguments:

* `name` - (Required) The name of the pipeline.
* `roleArn` - (Required) A service role Amazon Resource Name (ARN) that grants AWS CodePipeline permission to make calls to AWS services on your behalf.
* `artifactStore` (Required) One or more artifact_store blocks. Artifact stores are documented below.
* `stage` (Minimum of at least two `stage` blocks is required) A stage block. Stages are documented below.
* `tags` - (Optional) A map of tags to assign to the resource. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.

An `artifactStore` block supports the following arguments:

* `location` - (Required) The location where AWS CodePipeline stores artifacts for a pipeline; currently only `S3` is supported.
* `type` - (Required) The type of the artifact store, such as Amazon S3
* `encryptionKey` - (Optional) The encryption key block AWS CodePipeline uses to encrypt the data in the artifact store, such as an AWS Key Management Service (AWS KMS) key. If you don't specify a key, AWS CodePipeline uses the default key for Amazon Simple Storage Service (Amazon S3). An `encryption_key` block is documented below.
* `region` - (Optional) The region where the artifact store is located. Required for a cross-region CodePipeline, do not provide for a single-region CodePipeline.

An `encryptionKey` block supports the following arguments:

* `id` - (Required) The KMS key ARN or ID
* `type` - (Required) The type of key; currently only `KMS` is supported

A `stage` block supports the following arguments:

* `name` - (Required) The name of the stage.
* `action` - (Required) The action(s) to include in the stage. Defined as an `action` block below

An `action` block supports the following arguments:

* `category` - (Required) A category defines what kind of action can be taken in the stage, and constrains the provider type for the action. Possible values are `Approval`, `Build`, `Deploy`, `Invoke`, `Source` and `Test`.
* `owner` - (Required) The creator of the action being called. Possible values are `AWS`, `Custom` and `ThirdParty`.
* `name` - (Required) The action declaration's name.
* `provider` - (Required) The provider of the service being called by the action. Valid providers are determined by the action category. Provider names are listed in the [Action Structure Reference](https://docs.aws.amazon.com/codepipeline/latest/userguide/action-reference.html) documentation.
* `version` - (Required) A string that identifies the action type.
* `configuration` - (Optional) A map of the action declaration's configuration. Configurations options for action types and providers can be found in the [Pipeline Structure Reference](http://docs.aws.amazon.com/codepipeline/latest/userguide/reference-pipeline-structure.html#action-requirements) and [Action Structure Reference](https://docs.aws.amazon.com/codepipeline/latest/userguide/action-reference.html) documentation.
* `inputArtifacts` - (Optional) A list of artifact names to be worked on.
* `outputArtifacts` - (Optional) A list of artifact names to output. Output artifact names must be unique within a pipeline.
* `roleArn` - (Optional) The ARN of the IAM service role that will perform the declared action. This is assumed through the roleArn for the pipeline.
* `runOrder` - (Optional) The order in which actions are run.
* `region` - (Optional) The region in which to run the action.
* `namespace` - (Optional) The namespace all output variables will be accessed from.

~> **Note:** The input artifact of an action must exactly match the output artifact declared in a preceding action, but the input artifact does not have to be the next action in strict sequence from the action that provided the output artifact. Actions in parallel can declare different output artifacts, which are in turn consumed by different following actions.

## Attribute Reference

This resource exports the following attributes in addition to the arguments above:

* `id` - The codepipeline ID.
* `arn` - The codepipeline ARN.
* `tagsAll` - A map of tags assigned to the resource, including those inherited from the provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).

## Import

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import CodePipelines using the name. For example:

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
  }
}

```

Using `terraform import`, import CodePipelines using the name. For example:

```console
% terraform import aws_codepipeline.foo example
```

<!-- cache-key: cdktf-0.19.0 input-7564a4a21906390b235c7f254087ae49e059d302514c3158ce3d6d1c0c29ca5e -->