---
subcategory: "WAF"
layout: "aws"
page_title: "AWS: aws_wafv2_web_acl_rule_group_association"
description: |-
  Associates a WAFv2 Rule Group with a Web ACL by adding a rule that references the Rule Group.
---


<!-- Please do not edit this file, it is generated. -->
# Resource: aws_wafv2_web_acl_rule_group_association

Associates a WAFv2 Rule Group (custom or managed) with a Web ACL by adding a rule that references the Rule Group. Use this resource to apply the rules defined in a Rule Group to a Web ACL without duplicating rule definitions.

This resource supports both:

- **Custom Rule Groups**: User-created rule groups that you manage within your AWS account
- **Managed Rule Groups**: Pre-configured rule groups provided by AWS or third-party vendors

!> **Warning:** Verify the rule names in your `ruleActionOverride`s carefully. With managed rule groups, WAF silently ignores any override that uses an invalid rule name. With customer-owned rule groups, invalid rule names in your overrides will cause web ACL updates to fail. An invalid rule name is any name that doesn't exactly match the case-sensitive name of an existing rule in the rule group.

!> **Warning:** Using this resource will cause the associated Web ACL resource to show configuration drift in the `rule` argument unless you add `lifecycle { ignore_changes = [rule] }` to the Web ACL resource configuration. This is because this resource modifies the Web ACL's rules outside of the Web ACL resource's direct management.

~> **Note:** This resource creates a rule within the Web ACL that references the entire Rule Group. The rule group's individual rules are evaluated as a unit when requests are processed by the Web ACL.

## Example Usage

### Custom Rule Group - Basic Usage

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2RuleGroup } from "./.gen/providers/aws/wafv2-rule-group";
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const example = new Wafv2RuleGroup(this, "example", {
      capacity: 10,
      name: "example-rule-group",
      rule: [
        {
          action: {
            block: {},
          },
          name: "block-suspicious-requests",
          priority: 1,
          statement: {
            geoMatchStatement: {
              countryCodes: ["CN", "RU"],
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: true,
            metricName: "block-suspicious-requests",
            sampledRequestsEnabled: true,
          },
        },
      ],
      scope: "REGIONAL",
      visibilityConfig: {
        cloudwatchMetricsEnabled: true,
        metricName: "example-rule-group",
        sampledRequestsEnabled: true,
      },
    });
    const awsWafv2WebAclExample = new Wafv2WebAcl(this, "example_1", {
      defaultAction: {
        allow: {},
      },
      lifecycle: {
        ignoreChanges: [rule],
      },
      name: "example-web-acl",
      scope: "REGIONAL",
      visibilityConfig: {
        cloudwatchMetricsEnabled: true,
        metricName: "example-web-acl",
        sampledRequestsEnabled: true,
      },
    });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsWafv2WebAclExample.overrideLogicalId("example");
    const awsWafv2WebAclRuleGroupAssociationExample =
      new Wafv2WebAclRuleGroupAssociation(this, "example_2", {
        priority: 100,
        ruleGroupReference: [
          {
            arn: example.arn,
          },
        ],
        ruleName: "example-rule-group-rule",
        webAclArn: Token.asString(awsWafv2WebAclExample.arn),
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsWafv2WebAclRuleGroupAssociationExample.overrideLogicalId("example");
  }
}

```

### Managed Rule Group - Basic Usage

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const example = new Wafv2WebAcl(this, "example", {
      defaultAction: {
        allow: {},
      },
      lifecycle: {
        ignoreChanges: [rule],
      },
      name: "example-web-acl",
      scope: "REGIONAL",
      visibilityConfig: {
        cloudwatchMetricsEnabled: true,
        metricName: "example-web-acl",
        sampledRequestsEnabled: true,
      },
    });
    new Wafv2WebAclRuleGroupAssociation(this, "managed_example", {
      managedRuleGroup: [
        {
          name: "AWSManagedRulesCommonRuleSet",
          vendorName: "AWS",
        },
      ],
      priority: 50,
      ruleName: "aws-common-rule-set",
      webAclArn: example.arn,
    });
  }
}

```

### Managed Rule Group - With Version

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new Wafv2WebAclRuleGroupAssociation(this, "managed_versioned", {
      managedRuleGroup: [
        {
          name: "AWSManagedRulesCommonRuleSet",
          vendorName: "AWS",
          version: "Version_1.0",
        },
      ],
      priority: 60,
      ruleName: "aws-common-rule-set-versioned",
      webAclArn: example.arn,
    });
  }
}

```

### Managed Rule Group - With Rule Action Overrides

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new Wafv2WebAclRuleGroupAssociation(this, "managed_with_overrides", {
      managedRuleGroup: [
        {
          name: "AWSManagedRulesCommonRuleSet",
          ruleActionOverride: [
            {
              actionToUse: [
                {
                  count: [
                    {
                      customRequestHandling: [
                        {
                          insertHeader: [
                            {
                              name: "X-RFI-Override",
                              value: "counted",
                            },
                          ],
                        },
                      ],
                    },
                  ],
                },
              ],
              name: "GenericRFI_BODY",
            },
            {
              actionToUse: [
                {
                  captcha: [{}],
                },
              ],
              name: "SizeRestrictions_BODY",
            },
          ],
          vendorName: "AWS",
        },
      ],
      priority: 70,
      ruleName: "aws-common-rule-set-with-overrides",
      webAclArn: example.arn,
    });
  }
}

```

### Custom Rule Group - With Override Action

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new Wafv2WebAclRuleGroupAssociation(this, "example", {
      overrideAction: "count",
      priority: 100,
      ruleGroupReference: [
        {
          arn: Token.asString(awsWafv2RuleGroupExample.arn),
        },
      ],
      ruleName: "example-rule-group-rule",
      webAclArn: Token.asString(awsWafv2WebAclExample.arn),
    });
  }
}

```

### Custom Rule Group - With Rule Action Overrides

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2RuleGroup } from "./.gen/providers/aws/wafv2-rule-group";
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const example = new Wafv2RuleGroup(this, "example", {
      capacity: 10,
      name: "example-rule-group",
      rule: [
        {
          action: {
            block: {},
          },
          name: "geo-block-rule",
          priority: 1,
          statement: {
            geoMatchStatement: {
              countryCodes: ["CN", "RU"],
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: true,
            metricName: "geo-block-rule",
            sampledRequestsEnabled: true,
          },
        },
        {
          action: {
            block: {},
          },
          name: "rate-limit-rule",
          priority: 2,
          statement: {
            rateBasedStatement: {
              aggregateKeyType: "IP",
              limit: 1000,
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: true,
            metricName: "rate-limit-rule",
            sampledRequestsEnabled: true,
          },
        },
      ],
      scope: "REGIONAL",
      visibilityConfig: {
        cloudwatchMetricsEnabled: true,
        metricName: "example-rule-group",
        sampledRequestsEnabled: true,
      },
    });
    const awsWafv2WebAclExample = new Wafv2WebAcl(this, "example_1", {
      defaultAction: {
        allow: {},
      },
      lifecycle: {
        ignoreChanges: [rule],
      },
      name: "example-web-acl",
      scope: "REGIONAL",
      visibilityConfig: {
        cloudwatchMetricsEnabled: true,
        metricName: "example-web-acl",
        sampledRequestsEnabled: true,
      },
    });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsWafv2WebAclExample.overrideLogicalId("example");
    const awsWafv2WebAclRuleGroupAssociationExample =
      new Wafv2WebAclRuleGroupAssociation(this, "example_2", {
        priority: 100,
        ruleGroupReference: [
          {
            arn: example.arn,
            ruleActionOverride: [
              {
                actionToUse: [
                  {
                    count: [
                      {
                        customRequestHandling: [
                          {
                            insertHeader: [
                              {
                                name: "X-Geo-Block-Override",
                                value: "counted",
                              },
                            ],
                          },
                        ],
                      },
                    ],
                  },
                ],
                name: "geo-block-rule",
              },
              {
                actionToUse: [
                  {
                    captcha: [
                      {
                        customRequestHandling: [
                          {
                            insertHeader: [
                              {
                                name: "X-Rate-Limit-Override",
                                value: "captcha-required",
                              },
                            ],
                          },
                        ],
                      },
                    ],
                  },
                ],
                name: "rate-limit-rule",
              },
            ],
          },
        ],
        ruleName: "example-rule-group-rule",
        webAclArn: Token.asString(awsWafv2WebAclExample.arn),
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsWafv2WebAclRuleGroupAssociationExample.overrideLogicalId("example");
  }
}

```

### Custom Rule Group - CloudFront Web ACL

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2RuleGroup } from "./.gen/providers/aws/wafv2-rule-group";
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const cloudfrontExample = new Wafv2RuleGroup(this, "cloudfront_example", {
      capacity: 10,
      name: "cloudfront-rule-group",
      rule: [
        {
          action: {
            block: {},
          },
          name: "rate-limit",
          priority: 1,
          statement: {
            rateBasedStatement: {
              aggregateKeyType: "IP",
              limit: 2000,
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: true,
            metricName: "rate-limit",
            sampledRequestsEnabled: true,
          },
        },
      ],
      scope: "CLOUDFRONT",
      visibilityConfig: {
        cloudwatchMetricsEnabled: true,
        metricName: "cloudfront-rule-group",
        sampledRequestsEnabled: true,
      },
    });
    const awsWafv2WebAclCloudfrontExample = new Wafv2WebAcl(
      this,
      "cloudfront_example_1",
      {
        defaultAction: {
          allow: {},
        },
        lifecycle: {
          ignoreChanges: [rule],
        },
        name: "cloudfront-web-acl",
        scope: "CLOUDFRONT",
        visibilityConfig: {
          cloudwatchMetricsEnabled: true,
          metricName: "cloudfront-web-acl",
          sampledRequestsEnabled: true,
        },
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsWafv2WebAclCloudfrontExample.overrideLogicalId("cloudfront_example");
    const awsWafv2WebAclRuleGroupAssociationCloudfrontExample =
      new Wafv2WebAclRuleGroupAssociation(this, "cloudfront_example_2", {
        priority: 50,
        ruleGroupReference: [
          {
            arn: cloudfrontExample.arn,
          },
        ],
        ruleName: "cloudfront-rule-group-rule",
        webAclArn: Token.asString(awsWafv2WebAclCloudfrontExample.arn),
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsWafv2WebAclRuleGroupAssociationCloudfrontExample.overrideLogicalId(
      "cloudfront_example"
    );
  }
}

```

## Argument Reference

The following arguments are required:

* `ruleName` - (Required) Name of the rule to create in the Web ACL that references the rule group. Must be between 1 and 128 characters.
* `priority` - (Required) Priority of the rule within the Web ACL. Rules are evaluated in order of priority, with lower numbers evaluated first.
* `webAclArn` - (Required) ARN of the Web ACL to associate the Rule Group with.

The following arguments are optional:

* `managedRuleGroup` - (Optional) Managed Rule Group configuration. One of `ruleGroupReference` or `managedRuleGroup` is required. Conflicts with `ruleGroupReference`. [See below](#managed_rule_group).
* `overrideAction` - (Optional) Override action for the rule group. Valid values are `none` and `count`. Defaults to `none`. When set to `count`, the actions defined in the rule group rules are overridden to count matches instead of blocking or allowing requests.
* `region` - (Optional) Region where this resource will be [managed](https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints). Defaults to the Region set in the [provider configuration](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#aws-configuration-reference).
* `ruleGroupReference` - (Optional) Custom Rule Group reference configuration. One of `ruleGroupReference` or `managedRuleGroup` is required. Conflicts with `managedRuleGroup`. [See below](#rule_group_reference).

### rule_group_reference

* `arn` - (Required) ARN of the Rule Group to associate with the Web ACL.
* `ruleActionOverride` - (Optional) Override actions for specific rules within the rule group. [See below](#rule_action_override).

### managed_rule_group

* `name` - (Required) Name of the managed rule group.
* `vendorName` - (Required) Name of the managed rule group vendor. For AWS managed rule groups, this is `AWS`.
* `version` - (Optional) Version of the managed rule group. If not specified, the default version is used.
* `ruleActionOverride` - (Optional) Override actions for specific rules within the rule group. [See below](#rule_action_override).

### rule_action_override

* `name` - (Required) Name of the rule to override within the rule group. Verify the name carefully. With managed rule groups, WAF silently ignores any override that uses an invalid rule name. With customer-owned rule groups, invalid rule names in your overrides will cause web ACL updates to fail. An invalid rule name is any name that doesn't exactly match the case-sensitive name of an existing rule in the rule group.
* `actionToUse` - (Required) Action to use instead of the rule's original action. [See below](#action_to_use).

### action_to_use

Exactly one of the following action blocks must be specified:

* `allow` - (Optional) Allow the request. [See below](#allow).
* `block` - (Optional) Block the request. [See below](#block).
* `captcha` - (Optional) Require CAPTCHA verification. [See below](#captcha).
* `challenge` - (Optional) Require challenge verification. [See below](#challenge).
* `count` - (Optional) Count the request without taking action. [See below](#count).

### allow

* `customRequestHandling` - (Optional) Custom handling for allowed requests. [See below](#custom_request_handling).

### block

* `customResponse` - (Optional) Custom response for blocked requests. [See below](#custom_response).

### captcha

* `customRequestHandling` - (Optional) Custom handling for CAPTCHA requests. [See below](#custom_request_handling).

### challenge

* `customRequestHandling` - (Optional) Custom handling for challenge requests. [See below](#custom_request_handling).

### count

* `customRequestHandling` - (Optional) Custom handling for counted requests. [See below](#custom_request_handling).

### custom_request_handling

* `insertHeader` - (Required) Headers to insert into the request. [See below](#insert_header).

### custom_response

* `customResponseBodyKey` - (Optional) Key of a custom response body to use.
* `responseCode` - (Required) HTTP response code to return (200-599).
* `responseHeader` - (Optional) Headers to include in the response. [See below](#response_header).

### insert_header

* `name` - (Required) Name of the header to insert.
* `value` - (Required) Value of the header to insert.

### response_header

* `name` - (Required) Name of the response header.
* `value` - (Required) Value of the response header.

## Attribute Reference

This resource exports the following attributes in addition to the arguments above:

None.

## Timeouts

[Configuration options](https://developer.hashicorp.com/terraform/language/resources/syntax#operation-timeouts):

* `create` - (Default `30m`)
* `update` - (Default `30m`)
* `delete` - (Default `30m`)

## Import

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import WAFv2 web ACL custom rule group associations using `WebACLARN,RuleGroupARN,RuleName`. For example:

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    Wafv2WebAclRuleGroupAssociation.generateConfigForImport(
      this,
      "example",
      "arn:aws:wafv2:us-east-1:123456789012:regional/webacl/example-web-acl/12345678-1234-1234-1234-123456789012,arn:aws:wafv2:us-east-1:123456789012:regional/rulegroup/example-rule-group/87654321-4321-4321-4321-210987654321,example-rule-group-rule"
    );
  }
}

```

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import WAFv2 web ACL managed rule group associations using `WebACLARN,VendorName:RuleGroupName[:Version],RuleName`. For example:

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAclRuleGroupAssociation } from "./.gen/providers/aws/wafv2-web-acl-rule-group-association";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    Wafv2WebAclRuleGroupAssociation.generateConfigForImport(
      this,
      "managedExample",
      "arn:aws:wafv2:us-east-1:123456789012:regional/webacl/example-web-acl/12345678-1234-1234-1234-123456789012,AWS:AWSManagedRulesCommonRuleSet,aws-common-rule-set"
    );
  }
}

```

Using `terraform import`, import WAFv2 web ACL custom rule group associations using `WebACLARN,RuleGroupARN,RuleName`. For example:

```console
% terraform import aws_wafv2_web_acl_rule_group_association.example "arn:aws:wafv2:us-east-1:123456789012:regional/webacl/example-web-acl/12345678-1234-1234-1234-123456789012,arn:aws:wafv2:us-east-1:123456789012:regional/rulegroup/example-rule-group/87654321-4321-4321-4321-210987654321,example-rule-group-rule"
```

Using `terraform import`, import WAFv2 web ACL managed rule group associations using `WebACLARN,VendorName:RuleGroupName[:Version],RuleName`. For example:

```console
% terraform import aws_wafv2_web_acl_rule_group_association.managed_example "arn:aws:wafv2:us-east-1:123456789012:regional/webacl/example-web-acl/12345678-1234-1234-1234-123456789012,AWS:AWSManagedRulesCommonRuleSet,aws-common-rule-set"
```

<!-- cache-key: cdktf-0.20.8 input-5baf61e57f85b9a5671cd8d582332b3b4da4962187e28d363fb12f46bfcd6544 -->