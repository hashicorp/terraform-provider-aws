---
subcategory: "EC2 Image Builder"
layout: "aws"
page_title: "AWS: aws_imagebuilder_lifecycle_policy"
description: |-
  Manages an Image Builder Lifecycle Policy
---


<!-- Please do not edit this file, it is generated. -->
# Resource: aws_imagebuilder_lifecycle_policy

Manages an Image Builder Lifecycle Policy.

## Example Usage

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Fn, Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { ImagebuilderLifecyclePolicy } from "./.gen/providers/aws/";
import { DataAwsPartition } from "./.gen/providers/aws/data-aws-partition";
import { DataAwsRegion } from "./.gen/providers/aws/data-aws-region";
import { IamRole } from "./.gen/providers/aws/iam-role";
import { IamRolePolicyAttachment } from "./.gen/providers/aws/iam-role-policy-attachment";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const current = new DataAwsPartition(this, "current", {});
    const dataAwsRegionCurrent = new DataAwsRegion(this, "current_1", {});
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAwsRegionCurrent.overrideLogicalId("current");
    const example = new IamRole(this, "example", {
      assumeRolePolicy: Token.asString(
        Fn.jsonencode({
          Statement: [
            {
              Action: "sts:AssumeRole",
              Effect: "Allow",
              Principal: {
                Service: "imagebuilder.${" + current.dnsSuffix + "}",
              },
            },
          ],
          Version: "2012-10-17",
        })
      ),
      name: "example",
    });
    const awsIamRolePolicyAttachmentExample = new IamRolePolicyAttachment(
      this,
      "example_3",
      {
        policyArn:
          "arn:${" +
          current.partition +
          "}:iam::aws:policy/service-role/EC2ImageBuilderLifecycleExecutionPolicy",
        role: example.name,
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsIamRolePolicyAttachmentExample.overrideLogicalId("example");
    const awsImagebuilderLifecyclePolicyExample =
      new ImagebuilderLifecyclePolicy(this, "example_4", {
        dependsOn: [awsIamRolePolicyAttachmentExample],
        description: "Example description",
        executionRole: example.arn,
        name: "name",
        policyDetail: [
          {
            action: [
              {
                type: "DELETE",
              },
            ],
            filter: [
              {
                retainAtLeast: 10,
                type: "AGE",
                unit: "YEARS",
                value: 6,
              },
            ],
          },
        ],
        resourceSelection: [
          {
            tagMap: [
              {
                key1: "value1",
                key2: "value2",
              },
            ],
          },
        ],
        resourceType: "AMI_IMAGE",
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    awsImagebuilderLifecyclePolicyExample.overrideLogicalId("example");
  }
}

```

## Argument Reference

The following arguments are required:

* `name` - (Required) The name of the lifecycle policy to create.
* `resourceType` - (Required) The type of Image Builder resource that the lifecycle policy applies to. Valid values: `AMI_IMAGE` or `CONTAINER_IMAGE`.
* `executionRole` - (Required) The Amazon Resource Name (ARN) for the IAM role you create that grants Image Builder access to run lifecycle actions. More information about this role can be found [`here`](https://docs.aws.amazon.com/imagebuilder/latest/userguide/image-lifecycle-prerequisites.html#image-lifecycle-prereq-role).
* `policy_detail` - (Required) Configuration block with policy details. Detailed below.
* `resource_selection` - (Required) Selection criteria for the resources that the lifecycle policy applies to. Detailed below.

The following arguments are optional:

* `description` - (Optional) description for the lifecycle policy.
* `tags` - (Optional) Key-value map of resource tags for the Image Builder Lifecycle Policy. If configured with a provider [`defaultTags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.

### policy_detail

The following arguments are required:

* `action` - (Required) Configuration details for the policy action.
* `filter` - (Required) Specifies the resources that the lifecycle policy applies to.

The following arguments are optional:

* `exclusion_rules` - (Optional) Additional rules to specify resources that should be exempt from policy actions.

### action

The following arguments are required:

* `type` - (Required) Specifies the lifecycle action to take. Valid values: `DELETE`, `DEPRECATE` or `DISABLE`.

The following arguments are optional:

* `include_resources` - (Optional) Specifies the resources that the lifecycle policy applies to. Detailed below.

### include_resources

The following arguments are optional:

* `amis` - (Optional) Specifies whether the lifecycle action should apply to distributed AMIs.
* `containers` - (Optional) Specifies whether the lifecycle action should apply to distributed containers.
* `snapshots` - (Optional) Specifies whether the lifecycle action should apply to snapshots associated with distributed AMIs.

### filter

The following arguments are required:

* `type` - (Required) Filter resources based on either age or count. Valid values: `AGE` or `COUNT`.
* `value` - (Required) The number of units for the time period or for the count. For example, a value of 6 might refer to six months or six AMIs.

The following arguments are optional:

* `retain_at_least` - (Optional) For age-based filters, this is the number of resources to keep on hand after the lifecycle DELETE action is applied. Impacted resources are only deleted if you have more than this number of resources. If you have fewer resources than this number, the impacted resource is not deleted.
* `unit` - (Optional) Defines the unit of time that the lifecycle policy uses to determine impacted resources. This is required for age-based rules. Valid values: `DAYS`, `WEEKS`, `MONTHS` or `YEARS`.

### exclusion_rules

The following arguments are optional:

* `amis` - (Optional) Lists configuration values that apply to AMIs that Image Builder should exclude from the lifecycle action. Detailed below.
* `tag_map` - (Optional) Contains a list of tags that Image Builder uses to skip lifecycle actions for Image Builder image resources that have them.

### amis

The following arguments are optional:

* `is_public` - (Optional) Configures whether public AMIs are excluded from the lifecycle action.
* `last_launched` - (Optional) Specifies configuration details for Image Builder to exclude the most recent resources from lifecycle actions. Detailed below.
* `regions` - (Optional) Configures AWS Regions that are excluded from the lifecycle action.
* `sharedAccounts` - Specifies AWS accounts whose resources are excluded from the lifecycle action.
* `tag_map` - (Optional) Lists tags that should be excluded from lifecycle actions for the AMIs that have them.

### last_launched

The following arguments are required:

* `unit` - (Required) Defines the unit of time that the lifecycle policy uses to calculate elapsed time since the last instance launched from the AMI. For example: days, weeks, months, or years. Valid values: `DAYS`, `WEEKS`, `MONTHS` or `YEARS`.
* `value` - (Required) The integer number of units for the time period. For example 6 (months).

### resource_selection

The following arguments are optional:

* `recipe` - (Optional) A list of recipe that are used as selection criteria for the output images that the lifecycle policy applies to. Detailed below.
* `tag_map` - (Optional) A list of tags that are used as selection criteria for the Image Builder image resources that the lifecycle policy applies to.

### recipe

The following arguments are required:

* `name` - (Required) The name of an Image Builder recipe that the lifecycle policy uses for resource selection.
* `semanticVersion` - (Required) The version of the Image Builder recipe specified by the name field.

## Attribute Reference

This resource exports the following attributes in addition to the arguments above:

* `id` - Amazon Resource Name (ARN) of the lifecycle policy.
* `arn` - Amazon Resource Name (ARN) of the lifecycle policy.
* `status` - The status of the lifecycle policy.
* `tagsAll` - A map of tags assigned to the resource, including those inherited from the provider [`defaultTags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).

## Import

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import `aws_imagebuilder_lifecycle_policy` using the Amazon Resource Name (ARN). For example:

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { ImagebuilderLifecyclePolicy } from "./.gen/providers/aws/";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    ImagebuilderLifecyclePolicy.generateConfigForImport(
      this,
      "example",
      "arn:aws:imagebuilder:us-east-1:123456789012:lifecycle-policy/example"
    );
  }
}

```

Using `terraform import`, import `aws_imagebuilder_lifecycle_policy` using the Amazon Resource Name (ARN). For example:

```console
% terraform import aws_imagebuilder_lifecycle_policy.example arn:aws:imagebuilder:us-east-1:123456789012:lifecycle-policy/example
```

<!-- cache-key: cdktf-0.20.8 input-e47c0a84bfc85f3636ba59526b3ba15b735b78ce45f13395fbe0e7b5a895d493 -->