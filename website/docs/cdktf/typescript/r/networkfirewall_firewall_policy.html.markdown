---
subcategory: "Network Firewall"
layout: "aws"
page_title: "AWS: aws_networkfirewall_firewall_policy"
description: |-
  Provides an AWS Network Firewall Policy resource.
---


<!-- Please do not edit this file, it is generated. -->
# Resource: aws_networkfirewall_firewall_policy

Provides an AWS Network Firewall Firewall Policy Resource

## Example Usage

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { DataAwsCallerIdentity } from "./.gen/providers/aws/data-aws-caller-identity";
import { DataAwsPartition } from "./.gen/providers/aws/data-aws-partition";
import { DataAwsRegion } from "./.gen/providers/aws/data-aws-region";
import { NetworkfirewallFirewallPolicy } from "./.gen/providers/aws/networkfirewall-firewall-policy";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const current = new DataAwsCallerIdentity(this, "current", {});
    const dataAwsPartitionCurrent = new DataAwsPartition(this, "current_1", {});
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAwsPartitionCurrent.overrideLogicalId("current");
    const dataAwsRegionCurrent = new DataAwsRegion(this, "current_2", {});
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAwsRegionCurrent.overrideLogicalId("current");
    new NetworkfirewallFirewallPolicy(this, "example", {
      firewallPolicy: {
        statelessDefaultActions: ["aws:pass"],
        statelessFragmentDefaultActions: ["aws:drop"],
        statelessRuleGroupReference: [
          {
            priority: 1,
            resourceArn: Token.asString(awsNetworkfirewallRuleGroupExample.arn),
          },
        ],
        tlsInspectionConfigurationArn:
          "arn:${" +
          dataAwsPartitionCurrent.partition +
          "}:network-firewall:${" +
          dataAwsRegionCurrent.region +
          "}:${" +
          current.accountId +
          "}:tls-configuration/example",
      },
      name: "example",
      tags: {
        Tag1: "Value1",
        Tag2: "Value2",
      },
    });
  }
}

```

## Policy with a HOME_NET Override

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { NetworkfirewallFirewallPolicy } from "./.gen/providers/aws/networkfirewall-firewall-policy";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new NetworkfirewallFirewallPolicy(this, "example", {
      firewallPolicy: {
        policyVariables: {
          ruleVariables: [
            {
              ipSet: {
                definition: ["10.0.0.0/16", "10.1.0.0/24"],
              },
              key: "HOME_NET",
            },
          ],
        },
        statelessDefaultActions: ["aws:pass"],
        statelessFragmentDefaultActions: ["aws:drop"],
        statelessRuleGroupReference: [
          {
            priority: 1,
            resourceArn: Token.asString(awsNetworkfirewallRuleGroupExample.arn),
          },
        ],
      },
      name: "example",
      tags: {
        Tag1: "Value1",
        Tag2: "Value2",
      },
    });
  }
}

```

## Policy with a Custom Action for Stateless Inspection

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { NetworkfirewallFirewallPolicy } from "./.gen/providers/aws/networkfirewall-firewall-policy";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new NetworkfirewallFirewallPolicy(this, "example", {
      firewallPolicy: {
        statelessCustomAction: [
          {
            actionDefinition: {
              publishMetricAction: {
                dimension: [
                  {
                    value: "1",
                  },
                ],
              },
            },
            actionName: "ExampleCustomAction",
          },
        ],
        statelessDefaultActions: ["aws:pass", "ExampleCustomAction"],
        statelessFragmentDefaultActions: ["aws:drop"],
      },
      name: "example",
    });
  }
}

```

## Policy with Active Threat Defense in Action Order

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { DataAwsPartition } from "./.gen/providers/aws/data-aws-partition";
import { DataAwsRegion } from "./.gen/providers/aws/data-aws-region";
import { NetworkfirewallFirewallPolicy } from "./.gen/providers/aws/networkfirewall-firewall-policy";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const current = new DataAwsPartition(this, "current", {});
    const dataAwsRegionCurrent = new DataAwsRegion(this, "current_1", {});
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAwsRegionCurrent.overrideLogicalId("current");
    new NetworkfirewallFirewallPolicy(this, "example", {
      firewallPolicy: {
        statefulRuleGroupReference: [
          {
            deepThreatInspection: Token.asString(true),
            resourceArn:
              "arn:${" +
              current.partition +
              "}:network-firewall:${" +
              dataAwsRegionCurrent.region +
              "}:aws-managed:stateful-rulegroup/AttackInfrastructureActionOrder",
          },
        ],
        statelessDefaultActions: ["aws:pass"],
        statelessFragmentDefaultActions: ["aws:drop"],
      },
      name: "example",
    });
  }
}

```

## Policy with Active Threat Defense in Strict Order

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { DataAwsPartition } from "./.gen/providers/aws/data-aws-partition";
import { DataAwsRegion } from "./.gen/providers/aws/data-aws-region";
import { NetworkfirewallFirewallPolicy } from "./.gen/providers/aws/networkfirewall-firewall-policy";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const current = new DataAwsPartition(this, "current", {});
    const dataAwsRegionCurrent = new DataAwsRegion(this, "current_1", {});
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAwsRegionCurrent.overrideLogicalId("current");
    new NetworkfirewallFirewallPolicy(this, "example", {
      firewallPolicy: {
        statefulEngineOptions: {
          ruleOrder: "STRICT_ORDER",
        },
        statefulRuleGroupReference: [
          {
            deepThreatInspection: Token.asString(false),
            priority: 1,
            resourceArn:
              "arn:${" +
              current.partition +
              "}:network-firewall:${" +
              dataAwsRegionCurrent.region +
              "}:aws-managed:stateful-rulegroup/AttackInfrastructureStrictOrder",
          },
        ],
        statelessDefaultActions: ["aws:pass"],
        statelessFragmentDefaultActions: ["aws:drop"],
      },
      name: "example",
    });
  }
}

```

## Argument Reference

This resource supports the following arguments:

* `region` - (Optional) Region where this resource will be [managed](https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints). Defaults to the Region set in the [provider configuration](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#aws-configuration-reference).
* `description` - (Optional) A friendly description of the firewall policy.
* `encryptionConfiguration` - (Optional) KMS encryption configuration settings. See [Encryption Configuration](#encryption-configuration) below for details.
* `firewallPolicy` - (Required) A configuration block describing the rule groups and policy actions to use in the firewall policy. See [Firewall Policy](#firewall-policy) below for details.
* `name` - (Required, Forces new resource) A friendly name of the firewall policy.
* `tags` - (Optional) Map of resource tags to associate with the resource. If configured with a provider [`defaultTags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.

### Encryption Configuration

`encryptionConfiguration` settings for customer managed KMS keys. Remove this block to use the default AWS-managed KMS encryption (rather than setting `type` to `AWS_OWNED_KMS_KEY`).

* `keyId` - (Optional) The ID of the customer managed key. You can use any of the [key identifiers](https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#key-id) that KMS supports, unless you're using a key that's managed by another account. If you're using a key managed by another account, then specify the key ARN.
* `type` - (Required) The type of AWS KMS key to use for encryption of your Network Firewall resources. Valid values are `CUSTOMER_KMS` and `AWS_OWNED_KMS_KEY`.

### Firewall Policy

The `firewallPolicy` block supports the following arguments:

* `policyVariables` - (Optional). Contains variables that you can use to override default Suricata settings in your firewall policy. See [Rule Variables](#rule-variables) for details.

* `statefulDefaultActions` - (Optional) Set of actions to take on a packet if it does not match any stateful rules in the policy. This can only be specified if the policy has a `statefulEngineOptions` block with a `ruleOrder` value of `STRICT_ORDER`. You can specify one of either or neither values of `aws:drop_strict` or `aws:drop_established`, as well as any combination of `aws:alert_strict` and `aws:alert_established`.

* `statefulEngineOptions` - (Optional) A configuration block that defines options on how the policy handles stateful rules. See [Stateful Engine Options](#stateful-engine-options) below for details.

* `statefulRuleGroupReference` - (Optional) Set of configuration blocks containing references to the stateful rule groups that are used in the policy. See [Stateful Rule Group Reference](#stateful-rule-group-reference) below for details.

* `statelessCustomAction` - (Optional) Set of configuration blocks describing the custom action definitions that are available for use in the firewall policy's `statelessDefaultActions`. See [Stateless Custom Action](#stateless-custom-action) below for details.

* `statelessDefaultActions` - (Required) Set of actions to take on a packet if it does not match any of the stateless rules in the policy. You must specify one of the standard actions including: `aws:drop`, `aws:pass`, or `aws:forward_to_sfe`.
In addition, you can specify custom actions that are compatible with your standard action choice. If you want non-matching packets to be forwarded for stateful inspection, specify `aws:forward_to_sfe`.

* `statelessFragmentDefaultActions` - (Required) Set of actions to take on a fragmented packet if it does not match any of the stateless rules in the policy. You must specify one of the standard actions including: `aws:drop`, `aws:pass`, or `aws:forward_to_sfe`.
In addition, you can specify custom actions that are compatible with your standard action choice. If you want non-matching packets to be forwarded for stateful inspection, specify `aws:forward_to_sfe`.

* `statelessRuleGroupReference` - (Optional) Set of configuration blocks containing references to the stateless rule groups that are used in the policy. See [Stateless Rule Group Reference](#stateless-rule-group-reference) below for details.

* `tlsInspectionConfigurationArn` - (Optional) The (ARN) of the TLS Inspection policy to attach to the FW Policy.  This must be added at creation of the resource per AWS documentation. "You can only add a TLS inspection configuration to a new policy, not to an existing policy."  This cannot be removed from a FW Policy.

### Rule Variables

The `ruleVariables` block supports the following arguments:

* `key` - (Required) An alphanumeric string to identify the `ipSet`. Valid values: `HOME_NET`

* `ipSet` - (Required) A configuration block that defines a set of IP addresses. See [IP Set](#ip-set) below for details.

### IP Set

The `ipSet` block supports the following argument:

* `definition` - (Required) Set of IPv4 or IPv6 addresses in CIDR notation to use for the Suricata `HOME_NET` variable.

### Stateful Engine Options

The `statefulEngineOptions` block supports the following argument:

~> **NOTE:** If the `STRICT_ORDER` rule order is specified, this firewall policy can only reference stateful rule groups that utilize `STRICT_ORDER`.

* `flowTimeouts` - (Optional) Amount of time that can pass without any traffic sent through the firewall before the firewall determines that the connection is idle.

* `ruleOrder` - Indicates how to manage the order of stateful rule evaluation for the policy. Default value: `DEFAULT_ACTION_ORDER`. Valid values: `DEFAULT_ACTION_ORDER`, `STRICT_ORDER`.

* `streamExceptionPolicy` - Describes how to treat traffic which has broken midstream. Default value: `DROP`. Valid values: `DROP`, `CONTINUE`, `REJECT`.

### Flow Timeouts

The `flowTimeouts` block supports the following argument:

* `tcpIdleTimeoutSeconds` - Number of seconds that can pass without any TCP traffic sent through the firewall before the firewall determines that the connection is idle. After the idle timeout passes, data packets are dropped, however, the next TCP SYN packet is considered a new flow and is processed by the firewall. Clients or targets can use TCP keepalive packets to reset the idle timeout. Default value: `350`.

### Stateful Rule Group Reference

The `statefulRuleGroupReference` block supports the following arguments:

* `deepThreatInspection` - (Optional) Whether to enable deep threat inspection, which allows AWS to analyze service logs of network traffic processed by these rule groups to identify threat indicators across customers. AWS will use these threat indicators to improve the active threat defense managed rule groups and protect the security of AWS customers and services. This only applies to active threat defense maanaged rule groups.

  For details, refer to [AWS active threat defense for AWS Network Firewall](https://docs.aws.amazon.com/network-firewall/latest/developerguide/aws-managed-rule-groups-atd.html) in the AWS Network Firewall Developer Guide.
* `priority` - (Optional) An integer setting that indicates the order in which to apply the stateful rule groups in a single policy. This argument must be specified if the policy has a `statefulEngineOptions` block with a `ruleOrder` value of `STRICT_ORDER`. AWS Network Firewall applies each stateful rule group to a packet starting with the group that has the lowest priority setting.

* `resourceArn` - (Required) The Amazon Resource Name (ARN) of the stateful rule group.

* `override` - (Optional) Configuration block for override values

#### Override

* `action` - (Optional) The action that changes the rule group from DROP to ALERT . This only applies to managed rule groups.

### Stateless Custom Action

The `statelessCustomAction` block supports the following arguments:

* `actionDefinition` - (Required) A configuration block describing the custom action associated with the `actionName`. See [Action Definition](#action-definition) below for details.

* `actionName` - (Required, Forces new resource) A friendly name of the custom action.

### Stateless Rule Group Reference

The `statelessRuleGroupReference` block supports the following arguments:

* `priority` - (Required) An integer setting that indicates the order in which to run the stateless rule groups in a single policy. AWS Network Firewall applies each stateless rule group to a packet starting with the group that has the lowest priority setting.

* `resourceArn` - (Required) The Amazon Resource Name (ARN) of the stateless rule group.

### Action Definition

The `actionDefinition` block supports the following argument:

* `publishMetricAction` - (Required) A configuration block describing the stateless inspection criteria that publishes the specified metrics to Amazon CloudWatch for the matching packet. You can pair this custom action with any of the standard stateless rule actions. See [Publish Metric Action](#publish-metric-action) below for details.

### Publish Metric Action

The `publishMetricAction` block supports the following argument:

* `dimension` - (Required) Set of configuration blocks describing dimension settings to use for Amazon CloudWatch custom metrics. See [Dimension](#dimension) below for more details.

### Dimension

The `dimension` block supports the following argument:

* `value` - (Required) The string value to use in the custom metric dimension.

## Attribute Reference

This resource exports the following attributes in addition to the arguments above:

* `id` - The Amazon Resource Name (ARN) that identifies the firewall policy.

* `arn` - The Amazon Resource Name (ARN) that identifies the firewall policy.

* `tagsAll` - A map of tags assigned to the resource, including those inherited from the provider [`defaultTags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).

* `updateToken` - A string token used when updating a firewall policy.

## Import

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import Network Firewall Policies using their `arn`. For example:

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { NetworkfirewallFirewallPolicy } from "./.gen/providers/aws/networkfirewall-firewall-policy";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    NetworkfirewallFirewallPolicy.generateConfigForImport(
      this,
      "example",
      "arn:aws:network-firewall:us-west-1:123456789012:firewall-policy/example"
    );
  }
}

```

Using `terraform import`, import Network Firewall Policies using their `arn`. For example:

```console
% terraform import aws_networkfirewall_firewall_policy.example arn:aws:network-firewall:us-west-1:123456789012:firewall-policy/example
```

<!-- cache-key: cdktf-0.20.8 input-fe940c1d64f12cdee585523f199476863bd0f46c66d4df432670faf4203e35f5 -->