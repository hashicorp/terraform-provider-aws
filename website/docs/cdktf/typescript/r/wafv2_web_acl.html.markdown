---
subcategory: "WAF"
layout: "aws"
page_title: "AWS: aws_wafv2_web_acl"
description: |-
  Creates a WAFv2 Web ACL resource.
---


<!-- Please do not edit this file, it is generated. -->
# Resource: aws_wafv2_web_acl

Creates a WAFv2 Web ACL resource.

~> **Note** In `fieldToMatch` blocks, _e.g._, in `byteMatchStatement`, the `body` block includes an optional argument `oversizeHandling`. AWS indicates this argument will be required starting February 2023. To avoid configurations breaking when that change happens, treat the `oversizeHandling` argument as **required** as soon as possible.

## Example Usage

This resource is based on `aws_wafv2_rule_group`, check the documentation of the `aws_wafv2_rule_group` resource to see examples of the various available statements.

### Managed Rule

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new Wafv2WebAcl(this, "example", {
      defaultAction: {
        allow: {},
      },
      description: "Example of a managed rule.",
      name: "managed-rule-example",
      rule: [
        {
          name: "rule-1",
          overrideAction: {
            count: {},
          },
          priority: 1,
          statement: {
            managedRuleGroupStatement: {
              name: "AWSManagedRulesCommonRuleSet",
              ruleActionOverride: [
                {
                  actionToUse: {
                    count: {},
                  },
                  name: "SizeRestrictions_QUERYSTRING",
                },
                {
                  actionToUse: {
                    count: {},
                  },
                  name: "NoUserAgent_HEADER",
                },
              ],
              scopeDownStatement: {
                geoMatchStatement: {
                  countryCodes: ["US", "NL"],
                },
              },
              vendorName: "AWS",
            },
          },
          token_domains: ["mywebsite.com", "myotherwebsite.com"],
          visibilityConfig: {
            cloudwatchMetricsEnabled: false,
            metricName: "friendly-rule-metric-name",
            sampledRequestsEnabled: false,
          },
        },
      ],
      scope: "REGIONAL",
      tags: {
        Tag1: "Value1",
        Tag2: "Value2",
      },
      visibilityConfig: {
        cloudwatchMetricsEnabled: false,
        metricName: "friendly-metric-name",
        sampledRequestsEnabled: false,
      },
    });
  }
}

```

### Account Creation Fraud Prevention

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new Wafv2WebAcl(this, "acfp-example", {
      defaultAction: {
        allow: {},
      },
      description: "Example of a managed ACFP rule.",
      name: "managed-acfp-example",
      rule: [
        {
          name: "acfp-rule-1",
          overrideAction: {
            count: {},
          },
          priority: 1,
          statement: {
            managedRuleGroupStatement: {
              managedRuleGroupConfigs: [
                {
                  awsManagedRulesAcfpRuleSet: {
                    creationPath: "/signin",
                    registrationPagePath: "/register",
                    requestInspection: {
                      emailField: {
                        identifier: "/email",
                      },
                      passwordField: {
                        identifier: "/password",
                      },
                      payloadType: "JSON",
                      usernameField: {
                        identifier: "/username",
                      },
                    },
                    responseInspection: {
                      statusCode: {
                        failureCodes: [Token.asNumber("403")],
                        successCodes: [Token.asNumber("200")],
                      },
                    },
                  },
                },
              ],
              name: "AWSManagedRulesACFPRuleSet",
              vendorName: "AWS",
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: false,
            metricName: "friendly-rule-metric-name",
            sampledRequestsEnabled: false,
          },
        },
      ],
      scope: "CLOUDFRONT",
      visibilityConfig: {
        cloudwatchMetricsEnabled: false,
        metricName: "friendly-metric-name",
        sampledRequestsEnabled: false,
      },
    });
  }
}

```

### Account Takeover Protection

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { Token, TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new Wafv2WebAcl(this, "atp-example", {
      defaultAction: {
        allow: {},
      },
      description: "Example of a managed ATP rule.",
      name: "managed-atp-example",
      rule: [
        {
          name: "atp-rule-1",
          overrideAction: {
            count: {},
          },
          priority: 1,
          statement: {
            managedRuleGroupStatement: {
              managedRuleGroupConfigs: [
                {
                  awsManagedRulesAtpRuleSet: {
                    loginPath: "/api/1/signin",
                    requestInspection: {
                      passwordField: {
                        identifier: "/password",
                      },
                      payloadType: "JSON",
                      usernameField: {
                        identifier: "/email",
                      },
                    },
                    responseInspection: {
                      statusCode: {
                        failureCodes: [Token.asNumber("403")],
                        successCodes: [Token.asNumber("200")],
                      },
                    },
                  },
                },
              ],
              name: "AWSManagedRulesATPRuleSet",
              vendorName: "AWS",
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: false,
            metricName: "friendly-rule-metric-name",
            sampledRequestsEnabled: false,
          },
        },
      ],
      scope: "CLOUDFRONT",
      visibilityConfig: {
        cloudwatchMetricsEnabled: false,
        metricName: "friendly-metric-name",
        sampledRequestsEnabled: false,
      },
    });
  }
}

```

### Rate Based

Rate-limit US and NL-based clients to 10,000 requests for every 5 minutes.

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new Wafv2WebAcl(this, "example", {
      defaultAction: {
        allow: {},
      },
      description: "Example of a Cloudfront rate based statement.",
      name: "rate-based-example",
      rule: [
        {
          action: {
            block: {},
          },
          name: "rule-1",
          priority: 1,
          statement: {
            rateBasedStatement: {
              aggregateKeyType: "IP",
              limit: 10000,
              scopeDownStatement: {
                geoMatchStatement: {
                  countryCodes: ["US", "NL"],
                },
              },
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: false,
            metricName: "friendly-rule-metric-name",
            sampledRequestsEnabled: false,
          },
        },
      ],
      scope: "CLOUDFRONT",
      tags: {
        Tag1: "Value1",
        Tag2: "Value2",
      },
      visibilityConfig: {
        cloudwatchMetricsEnabled: false,
        metricName: "friendly-metric-name",
        sampledRequestsEnabled: false,
      },
    });
  }
}

```

### Rule Group Reference

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2RuleGroup } from "./.gen/providers/aws/wafv2-rule-group";
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    const example = new Wafv2RuleGroup(this, "example", {
      capacity: 10,
      name: "example-rule-group",
      rule: [
        {
          action: {
            count: {},
          },
          name: "rule-1",
          priority: 1,
          statement: {
            geoMatchStatement: {
              countryCodes: ["NL"],
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: false,
            metricName: "friendly-rule-metric-name",
            sampledRequestsEnabled: false,
          },
        },
        {
          action: {
            allow: {},
          },
          name: "rule-to-exclude-a",
          priority: 10,
          statement: {
            geoMatchStatement: {
              countryCodes: ["US"],
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: false,
            metricName: "friendly-rule-metric-name",
            sampledRequestsEnabled: false,
          },
        },
        {
          action: {
            allow: {},
          },
          name: "rule-to-exclude-b",
          priority: 15,
          statement: {
            geoMatchStatement: {
              countryCodes: ["GB"],
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: false,
            metricName: "friendly-rule-metric-name",
            sampledRequestsEnabled: false,
          },
        },
      ],
      scope: "REGIONAL",
      visibilityConfig: {
        cloudwatchMetricsEnabled: false,
        metricName: "friendly-metric-name",
        sampledRequestsEnabled: false,
      },
    });
    new Wafv2WebAcl(this, "test", {
      defaultAction: {
        block: {},
      },
      name: "rule-group-example",
      rule: [
        {
          name: "rule-1",
          overrideAction: {
            count: {},
          },
          priority: 1,
          statement: {
            ruleGroupReferenceStatement: {
              arn: example.arn,
              ruleActionOverride: [
                {
                  actionToUse: {
                    count: {},
                  },
                  name: "rule-to-exclude-b",
                },
                {
                  actionToUse: {
                    count: {},
                  },
                  name: "rule-to-exclude-a",
                },
              ],
            },
          },
          visibilityConfig: {
            cloudwatchMetricsEnabled: false,
            metricName: "friendly-rule-metric-name",
            sampledRequestsEnabled: false,
          },
        },
      ],
      scope: "REGIONAL",
      tags: {
        Tag1: "Value1",
        Tag2: "Value2",
      },
      visibilityConfig: {
        cloudwatchMetricsEnabled: false,
        metricName: "friendly-metric-name",
        sampledRequestsEnabled: false,
      },
    });
  }
}

```

### Large Request Body Inspections for Regional Resources

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    new Wafv2WebAcl(this, "example", {
      associationConfig: {
        requestBody: [
          {
            apiGateway: [
              {
                defaultSizeInspectionLimit: "KB_64",
              },
            ],
            appRunnerService: [
              {
                defaultSizeInspectionLimit: "KB_64",
              },
            ],
            cognitoUserPool: [
              {
                defaultSizeInspectionLimit: "KB_64",
              },
            ],
            verifiedAccessInstance: [
              {
                defaultSizeInspectionLimit: "KB_64",
              },
            ],
          },
        ],
      },
      defaultAction: {
        allow: {},
      },
      name: "large-request-body-example",
      scope: "REGIONAL",
      visibilityConfig: {
        cloudwatchMetricsEnabled: false,
        metricName: "friendly-metric-name",
        sampledRequestsEnabled: false,
      },
    });
  }
}

```

## Argument Reference

This resource supports the following arguments:

* `associationConfig` - (Optional) Specifies custom configurations for the associations between the web ACL and protected resources. See [`associationConfig`](#association_config-block) below for details.
* `captchaConfig` - (Optional) Specifies how AWS WAF should handle CAPTCHA evaluations on the ACL level (used by [AWS Bot Control](https://docs.aws.amazon.com/waf/latest/developerguide/aws-managed-rule-groups-bot.html)). See [`captchaConfig`](#captcha_config-block) below for details.
* `challengeConfig` - (Optional) Specifies how AWS WAF should handle Challenge evaluations on the ACL level (used by [AWS Bot Control](https://docs.aws.amazon.com/waf/latest/developerguide/aws-managed-rule-groups-bot.html)). See [`challengeConfig`](#challenge_config-block) below for details.
* `customResponseBody` - (Optional) Defines custom response bodies that can be referenced by `customResponse` actions. See [`customResponseBody`](#custom_response_body-block) below for details.
* `defaultAction` - (Required) Action to perform if none of the `rules` contained in the WebACL match. See [`defaultAction`](#default_action-block) below for details.
* `description` - (Optional) Friendly description of the WebACL.
* `name` - (Required, Forces new resource) Friendly name of the WebACL.
* `rule` - (Optional) Rule blocks used to identify the web requests that you want to `allow`, `block`, or `count`. See [`rule`](#rule-block) below for details.
* `scope` - (Required, Forces new resource) Specifies whether this is for an AWS CloudFront distribution or for a regional application. Valid values are `CLOUDFRONT` or `REGIONAL`. To work with CloudFront, you must also specify the region `us-east-1` (N. Virginia) on the AWS provider.
* `tags` - (Optional) Map of key-value pairs to associate with the resource. If configured with a provider [`defaultTags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.
* `tokenDomains` - (Optional) Specifies the domains that AWS WAF should accept in a web request token. This enables the use of tokens across multiple protected websites. When AWS WAF provides a token, it uses the domain of the AWS resource that the web ACL is protecting. If you don't specify a list of token domains, AWS WAF accepts tokens only for the domain of the protected resource. With a token domain list, AWS WAF accepts the resource's host domain plus all domains in the token domain list, including their prefixed subdomains.
* `visibilityConfig` - (Required) Defines and enables Amazon CloudWatch metrics and web request sample collection. See [`visibilityConfig`](#visibility_config-block) below for details.

### `associationConfig` Block

The `associationConfig` block supports the following arguments:

* `requestBody` - (Optional) Customizes the request body that your protected resource forward to AWS WAF for inspection. See [`requestBody`](#request_body-block) below for details.

### `customResponseBody` Block

Each `customResponseBody` block supports the following arguments:

* `key` - (Required) Unique key identifying the custom response body. This is referenced by the `customResponseBodyKey` argument in the [`customResponse`](#custom_response-block) block.
* `content` - (Required) Payload of the custom response.
* `contentType` - (Required) Type of content in the payload that you are defining in the `content` argument. Valid values are `TEXT_PLAIN`, `TEXT_HTML`, or `APPLICATION_JSON`.

### `defaultAction` Block

The `defaultAction` block supports the following arguments:

~> **Note** One of `allow` or `block` is required when specifying a `defaultAction`

* `allow` - (Optional) Specifies that AWS WAF should allow requests by default. See [`allow`](#allow-block) below for details.
* `block` - (Optional) Specifies that AWS WAF should block requests by default. See [`block`](#block-block) below for details.

### `rule` Block

~> **Note** One of `action` or `overrideAction` is required when specifying a rule

Each `rule` supports the following arguments:

* `action` - (Optional) Action that AWS WAF should take on a web request when it matches the rule's statement. This is used only for rules whose **statements do not reference a rule group**. See [`action`](#action-block) for details.
* `captchaConfig` - (Optional) Specifies how AWS WAF should handle CAPTCHA evaluations. See [`captchaConfig`](#captcha_config-block) below for details.
* `name` - (Required) Friendly name of the rule. Note that the provider assumes that rules with names matching this pattern, `^ShieldMitigationRuleGroup_<account-id>_<web-acl-guid>_.*`, are AWS-added for [automatic application layer DDoS mitigation activities](https://docs.aws.amazon.com/waf/latest/developerguide/ddos-automatic-app-layer-response-rg.html). Such rules will be ignored by the provider unless you explicitly include them in your configuration (for example, by using the AWS CLI to discover their properties and creating matching configuration). However, since these rules are owned and managed by AWS, you may get permission errors.
* `overrideAction` - (Optional) Override action to apply to the rules in a rule group. Used only for rule **statements that reference a rule group**, like `ruleGroupReferenceStatement` and `managedRuleGroupStatement`. See [`overrideAction`](#override_action-block) below for details.
* `priority` - (Required) If you define more than one Rule in a WebACL, AWS WAF evaluates each request against the `rules` in order based on the value of `priority`. AWS WAF processes rules with lower priority first.
* `ruleLabel` - (Optional) Labels to apply to web requests that match the rule match statement. See [`ruleLabel`](#rule_label-block) below for details.
* `statement` - (Required) The AWS WAF processing statement for the rule, for example `byteMatchStatement` or `geoMatchStatement`. See [`statement`](#statement-block) below for details.
* `visibilityConfig` - (Required) Defines and enables Amazon CloudWatch metrics and web request sample collection. See [`visibilityConfig`](#visibility_config-block) below for details.

### `action` Block

The `action` block supports the following arguments:

~> **Note** One of `allow`, `block`, or `count`, is required when specifying an `action`.

* `allow` - (Optional) Instructs AWS WAF to allow the web request. See [`allow`](#allow-block) below for details.
* `block` - (Optional) Instructs AWS WAF to block the web request. See [`block`](#block-block) below for details.
* `captcha` - (Optional) Instructs AWS WAF to run a Captcha check against the web request. See [`captcha`](#captcha-block) below for details.
* `challenge` - (Optional) Instructs AWS WAF to run a check against the request to verify that the request is coming from a legitimate client session. See [`challenge`](#challenge-block) below for details.
* `count` - (Optional) Instructs AWS WAF to count the web request and allow it. See [`count`](#count-block) below for details.

### `overrideAction` Block

The `overrideAction` block supports the following arguments:

~> **Note** One of `count` or `none`, expressed as an empty configuration block `{}`, is required when specifying an `overrideAction`

* `count` - (Optional) Override the rule action setting to count (i.e., only count matches). Configured as an empty block `{}`.
* `none` - (Optional) Don't override the rule action setting. Configured as an empty block `{}`.

### `allow` Block

The `allow` block supports the following arguments:

* `customRequestHandling` - (Optional) Defines custom handling for the web request. See [`customRequestHandling`](#custom_request_handling-block) below for details.

### `block` Block

The `block` block supports the following arguments:

* `customResponse` - (Optional) Defines a custom response for the web request. See [`customResponse`](#custom_response-block) below for details.

### `captcha` Block

The `captcha` block supports the following arguments:

* `customRequestHandling` - (Optional) Defines custom handling for the web request. See [`customRequestHandling`](#custom_request_handling-block) below for details.

### `challenge` Block

The `challenge` block supports the following arguments:

* `customRequestHandling` - (Optional) Defines custom handling for the web request. See [`customRequestHandling`](#custom_request_handling-block) below for details.

### `count` Block

The `count` block supports the following arguments:

* `customRequestHandling` - (Optional) Defines custom handling for the web request. See [`customRequestHandling`](#custom_request_handling-block) below for details.

### `customRequestHandling` Block

The `customRequestHandling` block supports the following arguments:

* `insertHeader` - (Required) The `insertHeader` blocks used to define HTTP headers added to the request. See [`insertHeader`](#insert_header-block) below for details.

### `insertHeader` Block

Each `insertHeader` block supports the following arguments. Duplicate header names are not allowed:

* `name` - Name of the custom header. For custom request header insertion, when AWS WAF inserts the header into the request, it prefixes this name `x-amzn-waf-`, to avoid confusion with the headers that are already in the request. For example, for the header name `sample`, AWS WAF inserts the header `x-amzn-waf-sample`.
* `value` - Value of the custom header.

### `customResponse` Block

The `customResponse` block supports the following arguments:

* `customResponseBodyKey` - (Optional) References the response body that you want AWS WAF to return to the web request client. This must reference a `key` defined in a `customResponseBody` block of this resource.
* `responseCode` - (Required) The HTTP status code to return to the client.
* `responseHeader` - (Optional) The `responseHeader` blocks used to define the HTTP response headers added to the response. See [`responseHeader`](#response_header-block) below for details.

### `responseHeader` Block

Each `responseHeader` block supports the following arguments. Duplicate header names are not allowed:

* `name` - Name of the custom header. For custom request header insertion, when AWS WAF inserts the header into the request, it prefixes this name `x-amzn-waf-`, to avoid confusion with the headers that are already in the request. For example, for the header name `sample`, AWS WAF inserts the header `x-amzn-waf-sample`.
* `value` - Value of the custom header.

### `ruleLabel` Block

Each block supports the following arguments:

* `name` - Label string.

### `statement` Block

The processing guidance for a Rule, used by AWS WAF to determine whether a web request matches the rule. See the [documentation](https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statements-list.html) for more information.

-> **Note** Although the `statement` block is recursive, currently only 3 levels are supported.

The `statement` block supports the following arguments:

* `andStatement` - (Optional) Logical rule statement used to combine other rule statements with AND logic. See [`andStatement`](#and_statement-block) below for details.
* `byteMatchStatement` - (Optional) Rule statement that defines a string match search for AWS WAF to apply to web requests. See [`byteMatchStatement`](#byte_match_statement-block) below for details.
* `geoMatchStatement` - (Optional) Rule statement used to identify web requests based on country of origin. See [`geoMatchStatement`](#geo_match_statement-block) below for details.
* `ipSetReferenceStatement` - (Optional) Rule statement used to detect web requests coming from particular IP addresses or address ranges. See [`ipSetReferenceStatement`](#ip_set_reference_statement-block) below for details.
* `labelMatchStatement` - (Optional) Rule statement that defines a string match search against labels that have been added to the web request by rules that have already run in the web ACL. See [`labelMatchStatement`](#label_match_statement-block) below for details.
* `managedRuleGroupStatement` - (Optional) Rule statement used to run the rules that are defined in a managed rule group.  This statement can not be nested. See [`managedRuleGroupStatement`](#managed_rule_group_statement-block) below for details.
* `notStatement` - (Optional) Logical rule statement used to negate the results of another rule statement. See [`notStatement`](#not_statement-block) below for details.
* `orStatement` - (Optional) Logical rule statement used to combine other rule statements with OR logic. See [`orStatement`](#or_statement-block) below for details.
* `rateBasedStatement` - (Optional) Rate-based rule tracks the rate of requests for each originating `IP address`, and triggers the rule action when the rate exceeds a limit that you specify on the number of requests in any `5-minute` time span. This statement can not be nested. See [`rateBasedStatement`](#rate_based_statement-block) below for details.
* `regexMatchStatement` - (Optional) Rule statement used to search web request components for a match against a single regular expression. See [`regexMatchStatement`](#regex_match_statement-block) below for details.
* `regexPatternSetReferenceStatement` - (Optional) Rule statement used to search web request components for matches with regular expressions. See [`regexPatternSetReferenceStatement`](#regex_pattern_set_reference_statement-block) below for details.
* `ruleGroupReferenceStatement` - (Optional) Rule statement used to run the rules that are defined in an WAFv2 Rule Group. See [`ruleGroupReferenceStatement`](#rule_group_reference_statement-block) below for details.
* `sizeConstraintStatement` - (Optional) Rule statement that compares a number of bytes against the size of a request component, using a comparison operator, such as greater than (>) or less than (<). See [`sizeConstraintStatement`](#size_constraint_statement-block) below for more details.
* `sqliMatchStatement` - (Optional) An SQL injection match condition identifies the part of web requests, such as the URI or the query string, that you want AWS WAF to inspect. See [`sqliMatchStatement`](#sqli_match_statement-block) below for details.
* `xssMatchStatement` - (Optional) Rule statement that defines a cross-site scripting (XSS) match search for AWS WAF to apply to web requests. See [`xssMatchStatement`](#xss_match_statement-block) below for details.

### `andStatement` Block

A logical rule statement used to combine other rule statements with `AND` logic. You provide more than one `statement` within the `andStatement`.

The `andStatement` block supports the following arguments:

* `statement` - (Required) Statements to combine with `AND` logic. You can use any statements that can be nested. See [`statement`](#statement-block) above for details.

### `byteMatchStatement` Block

The byte match statement provides the bytes to search for, the location in requests that you want AWS WAF to search, and other settings. The bytes to search for are typically a string that corresponds with ASCII characters.

The `byteMatchStatement` block supports the following arguments:

* `fieldToMatch` - (Optional) Part of a web request that you want AWS WAF to inspect. See [`fieldToMatch`](#field_to_match-block) below for details.
* `positionalConstraint` - (Required) Area within the portion of a web request that you want AWS WAF to search for `searchString`. Valid values include the following: `EXACTLY`, `STARTS_WITH`, `ENDS_WITH`, `CONTAINS`, `CONTAINS_WORD`. See the AWS [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_ByteMatchStatement.html) for more information.
* `searchString` - (Required) String value that you want AWS WAF to search for. AWS WAF searches only in the part of web requests that you designate for inspection in `fieldToMatch`. The maximum length of the value is 50 bytes.
* `textTransformation` - (Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. At least one transformation is required. See [`textTransformation`](#text_transformation-block) below for details.

### `geoMatchStatement` Block

The `geoMatchStatement` block supports the following arguments:

* `countryCodes` - (Required) Array of two-character country codes, for example, [ "US", "CN" ], from the alpha-2 country ISO codes of the `ISO 3166` international standard. See the [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_GeoMatchStatement.html) for valid values.
* `forwardedIpConfig` - (Optional) Configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. See [`forwardedIpConfig`](#forwarded_ip_config-block) below for details.

### `ipSetReferenceStatement` Block

A rule statement used to detect web requests coming from particular IP addresses or address ranges. To use this, create an `aws_wafv2_ip_set` that specifies the addresses you want to detect, then use the `ARN` of that set in this statement.

The `ipSetReferenceStatement` block supports the following arguments:

* `arn` - (Required) The Amazon Resource Name (ARN) of the IP Set that this statement references.
* `ipSetForwardedIpConfig` - (Optional) Configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. See [`ipSetForwardedIpConfig`](#ip_set_forwarded_ip_config-block) below for more details.

### `labelMatchStatement` Block

The `labelMatchStatement` block supports the following arguments:

* `scope` - (Required) Specify whether you want to match using the label name or just the namespace. Valid values are `LABEL` or `NAMESPACE`.
* `key` - (Required) String to match against.

### `managedRuleGroupStatement` Block

A rule statement used to run the rules that are defined in a managed rule group.

You can't nest a `managedRuleGroupStatement`, for example for use inside a `notStatement` or `orStatement`. It can only be referenced as a `top-level` statement within a `rule`.

The `managedRuleGroupStatement` block supports the following arguments:

* `name` - (Required) Name of the managed rule group.
* `ruleActionOverride` - (Optional) Action settings to use in the place of the rule actions that are configured inside the rule group. You specify one override for each rule whose action you want to change. See [`ruleActionOverride`](#rule_action_override-block) below for details.
* `managedRuleGroupConfigs`- (Optional) Additional information that's used by a managed rule group. Only one rule attribute is allowed in each config. See [`managedRuleGroupConfigs`](#managed_rule_group_configs-block) for more details
* `scopeDownStatement` - Narrows the scope of the statement to matching web requests. This can be any nestable statement, and you can nest statements at any level below this scope-down statement. See [`statement`](#statement-block) above for details.
* `vendorName` - (Required) Name of the managed rule group vendor.
* `version` - (Optional) Version of the managed rule group. You can set `Version_1.0` or `Version_1.1` etc. If you want to use the default version, do not set anything.

### `notStatement` Block

A logical rule statement used to negate the results of another rule statement. You provide one `statement` within the `notStatement`.

The `notStatement` block supports the following arguments:

* `statement` - (Required) Statement to negate. You can use any statement that can be nested. See [`statement`](#statement-block) above for details.

### `orStatement` Block

A logical rule statement used to combine other rule statements with `OR` logic. You provide more than one `statement` within the `orStatement`.

The `orStatement` block supports the following arguments:

* `statement` - (Required) Statements to combine with `OR` logic. You can use any statements that can be nested. See [`statement`](#statement-block) above for details.

### `rateBasedStatement` Block

A rate-based rule tracks the rate of requests for each originating IP address, and triggers the rule action when the rate exceeds a limit that you specify on the number of requests in any 5-minute time span. You can use this to put a temporary block on requests from an IP address that is sending excessive requests. See the [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_RateBasedStatement.html) for more information.

You can't nest a `rateBasedStatement`, for example for use inside a `notStatement` or `orStatement`. It can only be referenced as a `top-level` statement within a `rule`.

The `rateBasedStatement` block supports the following arguments:

* `aggregateKeyType` - (Optional) Setting that indicates how to aggregate the request counts. Valid values include: `CONSTANT`, `CUSTOM_KEYS`, `FORWARDED_IP`, or `IP`. Default: `IP`.
* `customKey` - (Optional) Aggregate the request counts using one or more web request components as the aggregate keys. See [`customKey`](#custom_key-block) below for details.
* `evaluationWindowSec` - (Optional) The amount of time, in seconds, that AWS WAF should include in its request counts, looking back from the current time. Valid values are `60`, `120`, `300`, and `600`. Defaults to `300` (5 minutes).

  **NOTE:** This setting doesn't determine how often AWS WAF checks the rate, but how far back it looks each time it checks. AWS WAF checks the rate about every 10 seconds.
* `forwardedIpConfig` - (Optional) Configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. If `aggregateKeyType` is set to `FORWARDED_IP`, this block is required. See [`forwardedIpConfig`](#forwarded_ip_config-block) below for details.
* `limit` - (Required) Limit on requests per 5-minute period for a single originating IP address.
* `scopeDownStatement` - (Optional) Optional nested statement that narrows the scope of the rate-based statement to matching web requests. This can be any nestable statement, and you can nest statements at any level below this scope-down statement. See [`statement`](#statement-block) above for details. If `aggregateKeyType` is set to `CONSTANT`, this block is required.

### `regexMatchStatement` Block

A rule statement used to search web request components for a match against a single regular expression.

The `regexMatchStatement` block supports the following arguments:

* `regexString` - (Required) String representing the regular expression. Minimum of `1` and maximum of `512` characters.
* `fieldToMatch` - (Required) The part of a web request that you want AWS WAF to inspect. See [`fieldToMatch`](#field_to_match-block) below for details.
* `textTransformation` - (Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. At least one transformation is required. See [`textTransformation`](#text_transformation-block) below for details.

### `regexPatternSetReferenceStatement` Block

A rule statement used to search web request components for matches with regular expressions. To use this, create a `aws_wafv2_regex_pattern_set` that specifies the expressions that you want to detect, then use the `ARN` of that set in this statement. A web request matches the pattern set rule statement if the request component matches any of the patterns in the set.

The `regexPatternSetReferenceStatement` block supports the following arguments:

* `arn` - (Required) The Amazon Resource Name (ARN) of the Regex Pattern Set that this statement references.
* `fieldToMatch` - (Optional) Part of a web request that you want AWS WAF to inspect. See [`fieldToMatch`](#field_to_match-block) below for details.
* `textTransformation` - (Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. At least one transformation is required. See [`textTransformation`](#text_transformation-block) below for details.

### `ruleGroupReferenceStatement` Block

A rule statement used to run the rules that are defined in an WAFv2 Rule Group or `aws_wafv2_rule_group` resource.

You can't nest a `ruleGroupReferenceStatement`, for example for use inside a `notStatement` or `orStatement`. It can only be referenced as a `top-level` statement within a `rule`.

The `ruleGroupReferenceStatement` block supports the following arguments:

* `arn` - (Required) The Amazon Resource Name (ARN) of the `aws_wafv2_rule_group` resource.
* `ruleActionOverride` - (Optional) Action settings to use in the place of the rule actions that are configured inside the rule group. You specify one override for each rule whose action you want to change. See [`ruleActionOverride`](#rule_action_override-block) below for details.

### `sizeConstraintStatement` Block

A rule statement that uses a comparison operator to compare a number of bytes against the size of a request component. AWS WAFv2 inspects up to the first 8192 bytes (8 KB) of a request body, and when inspecting the request URI Path, the slash `/` in
the URI counts as one character.

The `sizeConstraintStatement` block supports the following arguments:

* `comparisonOperator` - (Required) Operator to use to compare the request part to the size setting. Valid values include: `EQ`, `NE`, `LE`, `LT`, `GE`, or `GT`.
* `fieldToMatch` - (Optional) Part of a web request that you want AWS WAF to inspect. See [`fieldToMatch`](#field_to_match-block) below for details.
* `size` - (Required) Size, in bytes, to compare to the request part, after any transformations. Valid values are integers between 0 and 21474836480, inclusive.
* `textTransformation` - (Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. At least one transformation is required. See [`textTransformation`](#text_transformation-block) below for details.

### `sqliMatchStatement` Block

An SQL injection match condition identifies the part of web requests, such as the URI or the query string, that you want AWS WAF to inspect. Later in the process, when you create a web ACL, you specify whether to allow or block requests that appear to contain malicious SQL code.

The `sqliMatchStatement` block supports the following arguments:

* `fieldToMatch` - (Optional) Part of a web request that you want AWS WAF to inspect. See [`fieldToMatch`](#field_to_match-block) below for details.
* `textTransformation` - (Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. At least one transformation is required. See [`textTransformation`](#text_transformation-block) below for details.

### `xssMatchStatement` Block

The XSS match statement provides the location in requests that you want AWS WAF to search and text transformations to use on the search area before AWS WAF searches for character sequences that are likely to be malicious strings.

The `xssMatchStatement` block supports the following arguments:

* `fieldToMatch` - (Optional) Part of a web request that you want AWS WAF to inspect. See [`fieldToMatch`](#field_to_match-block) below for details.
* `textTransformation` - (Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. At least one transformation is required. See [`textTransformation`](#text_transformation-block) below for details.

### `ruleActionOverride` Block

The `ruleActionOverride` block supports the following arguments:

* `actionToUse` - (Required) Override action to use, in place of the configured action of the rule in the rule group. See [`action`](#action-block) for details.
* `name` - (Required) Name of the rule to override. See the [documentation](https://docs.aws.amazon.com/waf/latest/developerguide/aws-managed-rule-groups-list.html) for a list of names in the appropriate rule group in use.

### `managedRuleGroupConfigs` Block

The `managedRuleGroupConfigs` block support the following arguments:

* `awsManagedRulesBotControlRuleSet` - (Optional) Additional configuration for using the Bot Control managed rule group. Use this to specify the inspection level that you want to use. See [`awsManagedRulesBotControlRuleSet`](#aws_managed_rules_bot_control_rule_set-block) for more details
* `awsManagedRulesAcfpRuleSet` - (Optional) Additional configuration for using the Account Creation Fraud Prevention managed rule group. Use this to specify information such as the registration page of your application and the type of content to accept or reject from the client.
* `awsManagedRulesAtpRuleSet` - (Optional) Additional configuration for using the Account Takeover Protection managed rule group. Use this to specify information such as the sign-in page of your application and the type of content to accept or reject from the client.
* `loginPath` - (Optional, **Deprecated**) The path of the login endpoint for your application.
* `passwordField` - (Optional, **Deprecated**) Details about your login page password field. See [`passwordField`](#password_field-block) for more details.
* `payloadType`- (Optional, **Deprecated**) The payload type for your login endpoint, either JSON or form encoded.
* `usernameField` - (Optional, **Deprecated**) Details about your login page username field. See [`usernameField`](#username_field-block) for more details.

### `awsManagedRulesBotControlRuleSet` Block

* `enableMachineLearning` - (Optional) Applies only to the targeted inspection level. Determines whether to use machine learning (ML) to analyze your web traffic for bot-related activity. Defaults to `true`.
* `inspectionLevel` - (Optional) The inspection level to use for the Bot Control rule group.

### `awsManagedRulesAcfpRuleSet` Block

* `creationPath` - (Required) The path of the account creation endpoint for your application. This is the page on your website that accepts the completed registration form for a new user. This page must accept POST requests.
* `enableRegexInPath` - (Optional) Whether or not to allow the use of regular expressions in the login page path.
* `registrationPagePath` - (Required) The path of the account registration endpoint for your application. This is the page on your website that presents the registration form to new users. This page must accept GET text/html requests.
* `requestInspection` - (Optional) The criteria for inspecting login requests, used by the ATP rule group to validate credentials usage. See [`requestInspection`](#request_inspection-block) for more details.
* `responseInspection` - (Optional) The criteria for inspecting responses to login requests, used by the ATP rule group to track login failure rates. Note that Response Inspection is available only on web ACLs that protect CloudFront distributions. See [`responseInspection`](#response_inspection-block) for more details.

### `awsManagedRulesAtpRuleSet` Block

* `enableRegexInPath` - (Optional) Whether or not to allow the use of regular expressions in the login page path.
* `loginPath` - (Required) The path of the login endpoint for your application.
* `requestInspection` - (Optional) The criteria for inspecting login requests, used by the ATP rule group to validate credentials usage. See [`requestInspection`](#request_inspection-block) for more details.
* `responseInspection` - (Optional) The criteria for inspecting responses to login requests, used by the ATP rule group to track login failure rates. Note that Response Inspection is available only on web ACLs that protect CloudFront distributions. See [`responseInspection`](#response_inspection-block) for more details.

### `requestInspection` Block

* `addressFields` (Optional) The names of the fields in the request payload that contain your customer's primary physical address. See [`addressFields`](#address_fields-block) for more details.
* `emailField` (Optional) The name of the field in the request payload that contains your customer's email. See [`emailField`](#email_field-block) for more details.
* `passwordField` (Optional) Details about your login page password field. See [`passwordField`](#password_field-block) for more details.
* `payloadType` (Required) The payload type for your login endpoint, either JSON or form encoded.
* `phoneNumberFields` (Optional) The names of the fields in the request payload that contain your customer's primary phone number. See [`phoneNumberFields`](#phone_number_fields-block) for more details.
* `usernameField` (Optional) Details about your login page username field. See [`usernameField`](#username_field-block) for more details.

### `addressFields` Block

* `identifier` - (Required) The name of a single primary address field.

### `emailField` Block

* `identifier` - (Required) The name of the field in the request payload that contains your customer's email.

### `passwordField` Block

* `identifier` - (Required) The name of the password field.

### `phoneNumberFields` Block

* `identifier` - (Required) The name of a single primary phone number field.

### `usernameField` Block

* `identifier` - (Required) The name of the username field.

### `responseInspection` Block

* `bodyContains` (Optional) Configures inspection of the response body. See [`bodyContains`](#body_contains-block) for more details.
* `header` (Optional) Configures inspection of the response header.See [`header`](#header-block) for more details.
* `json` (Optional) Configures inspection of the response JSON. See [`json`](#json-block) for more details.
* `statusCode` (Optional) Configures inspection of the response status code.See [`statusCode`](#status_code-block) for more details.

### `bodyContains` Block

* `successStrings` (Required) Strings in the body of the response that indicate a successful login attempt.
* `failureStrings` (Required) Strings in the body of the response that indicate a failed login attempt.

### `header` Block

* `name` (Required) The name of the header to match against. The name must be an exact match, including case.
* `successValues` (Required) Values in the response header with the specified name that indicate a successful login attempt.
* `failureValues` (Required) Values in the response header with the specified name that indicate a failed login attempt.

### `json` Block

* `identifier` (Required) The identifier for the value to match against in the JSON.
* `successStrings` (Required) Strings in the body of the response that indicate a successful login attempt.
* `failureStrings` (Required) Strings in the body of the response that indicate a failed login attempt.

### `statusCode` Block

* `successCodes` (Required) Status codes in the response that indicate a successful login attempt.
* `failureCodes` (Required) Status codes in the response that indicate a failed login attempt.

### `fieldToMatch` Block

The part of a web request that you want AWS WAF to inspect. Include the single `fieldToMatch` type that you want to inspect, with additional specifications as needed, according to the type. You specify a single request component in `fieldToMatch` for each rule statement that requires it. To inspect more than one component of a web request, create a separate rule statement for each component. See the [documentation](https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-fields.html#waf-rule-statement-request-component) for more details.

The `fieldToMatch` block supports the following arguments:

~> **Note** Only one of `allQueryArguments`, `body`, `cookies`, `headerOrder`, `headers`, `ja3Fingerprint`, `jsonBody`, `method`, `queryString`, `singleHeader`, `singleQueryArgument`, or `uriPath` can be specified. An empty configuration block `{}` should be used when specifying `allQueryArguments`, `method`, or `queryString` attributes.

* `allQueryArguments` - (Optional) Inspect all query arguments.
* `body` - (Optional) Inspect the request body, which immediately follows the request headers. See [`body`](#body-block) below for details.
* `cookies` - (Optional) Inspect the cookies in the web request. See [`cookies`](#cookies-block) below for details.
* `headerOrder` - (Optional) Inspect a string containing the list of the request's header names, ordered as they appear in the web request that AWS WAF receives for inspection. See [`headerOrder`](#header_order-block) below for details.
* `headers` - (Optional) Inspect the request headers. See [`headers`](#headers-block) below for details.
* `ja3Fingerprint` - (Optional) Inspect the JA3 fingerprint. See [`ja3Fingerprint`](#ja3_fingerprint-block) below for details.
* `jsonBody` - (Optional) Inspect the request body as JSON. See [`jsonBody`](#json_body-block) for details.
* `method` - (Optional) Inspect the HTTP method. The method indicates the type of operation that the request is asking the origin to perform.
* `queryString` - (Optional) Inspect the query string. This is the part of a URL that appears after a `?` character, if any.
* `singleHeader` - (Optional) Inspect a single header. See [`singleHeader`](#single_header-block) below for details.
* `singleQueryArgument` - (Optional) Inspect a single query argument. See [`singleQueryArgument`](#single_query_argument-block) below for details.
* `uriPath` - (Optional) Inspect the request URI path. This is the part of a web request that identifies a resource, for example, `/images/daily-ad.jpg`.

### `forwardedIpConfig` Block

The configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. Commonly, this is the X-Forwarded-For (XFF) header, but you can specify any header name. If the specified header isn't present in the request, AWS WAFv2 doesn't apply the rule to the web request at all. AWS WAFv2 only evaluates the first IP address found in the specified HTTP header.

The `forwardedIpConfig` block supports the following arguments:

* `fallbackBehavior` - (Required) - Match status to assign to the web request if the request doesn't have a valid IP address in the specified position. Valid values include: `MATCH` or `NO_MATCH`.
* `headerName` - (Required) - Name of the HTTP header to use for the IP address.

### `ipSetForwardedIpConfig` Block

The configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. Commonly, this is the X-Forwarded-For (XFF) header, but you can specify any header name.

The `ipSetForwardedIpConfig` block supports the following arguments:

* `fallbackBehavior` - (Required) - Match status to assign to the web request if the request doesn't have a valid IP address in the specified position. Valid values include: `MATCH` or `NO_MATCH`.
* `headerName` - (Required) - Name of the HTTP header to use for the IP address.
* `position` - (Required) - Position in the header to search for the IP address. Valid values include: `FIRST`, `LAST`, or `ANY`. If `ANY` is specified and the header contains more than 10 IP addresses, AWS WAFv2 inspects the last 10.

### `headerOrder` Block

Inspect a string containing the list of the request's header names, ordered as they appear in the web request that AWS WAF receives for inspection. AWS WAF generates the string and then uses that as the field to match component in its inspection. AWS WAF separates the header names in the string using colons and no added spaces, for example `host:user-agent:accept:authorization:referer`.

The `headerOrder` block supports the following arguments:

* `oversizeHandling` - (Required) Oversize handling tells AWS WAF what to do with a web request when the request component that the rule inspects is over the limits. Valid values include the following: `CONTINUE`, `MATCH`, `NO_MATCH`. See the AWS [documentation](https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-oversize-handling.html) for more information.

### `headers` Block

Inspect the request headers.

The `headers` block supports the following arguments:

* `matchPattern` - (Required) The filter to use to identify the subset of headers to inspect in a web request. The `matchPattern` block supports only one of the following arguments:
    * `all` - An empty configuration block that is used for inspecting all headers.
    * `includedHeaders` - An array of strings that will be used for inspecting headers that have a key that matches one of the provided values.
    * `excludedHeaders` - An array of strings that will be used for inspecting headers that do not have a key that matches one of the provided values.
* `matchScope` - (Required) The parts of the headers to inspect with the rule inspection criteria. If you specify `All`, AWS WAF inspects both keys and values. Valid values include the following: `ALL`, `Key`, `Value`.
* `oversizeHandling` - (Required) Oversize handling tells AWS WAF what to do with a web request when the request component that the rule inspects is over the limits. Valid values include the following: `CONTINUE`, `MATCH`, `NO_MATCH`. See the AWS [documentation](https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-oversize-handling.html) for more information.

### `ja3Fingerprint` Block

The `ja3Fingerprint` block supports the following arguments:

* `fallbackBehavior` - (Required) The match status to assign to the web request if the request doesn't have a JA3 fingerprint. Valid values include: `MATCH` or `NO_MATCH`.

### `jsonBody` Block

The `jsonBody` block supports the following arguments:

* `invalidFallbackBehavior` - (Optional) What to do when JSON parsing fails. Defaults to evaluating up to the first parsing failure. Valid values are `EVALUATE_AS_STRING`, `MATCH` and `NO_MATCH`.
* `matchPattern` - (Required) The patterns to look for in the JSON body. You must specify exactly one setting: either `all` or `includedPaths`. See [JsonMatchPattern](https://docs.aws.amazon.com/waf/latest/APIReference/API_JsonMatchPattern.html) for details.
* `matchScope` - (Required) The parts of the JSON to match against using the `matchPattern`. Valid values are `ALL`, `KEY` and `VALUE`.
* `oversizeHandling` - (Optional) What to do if the body is larger than can be inspected. Valid values are `CONTINUE` (default), `MATCH` and `NO_MATCH`.

### `singleHeader` Block

Inspect a single header. Provide the name of the header to inspect, for example, `User-Agent` or `Referer` (provided as lowercase strings).

The `singleHeader` block supports the following arguments:

* `name` - (Required) Name of the query header to inspect. This setting must be provided as lower case characters.

### `singleQueryArgument` Block

Inspect a single query argument. Provide the name of the query argument to inspect, such as `UserName` or `SalesRegion` (provided as lowercase strings).

The `singleQueryArgument` block supports the following arguments:

* `name` - (Required) Name of the query header to inspect. This setting must be provided as lower case characters.

### `body` Block

The `body` block supports the following arguments:

* `oversizeHandling` - (Optional) What WAF should do if the body is larger than WAF can inspect. WAF does not support inspecting the entire contents of the body of a web request when the body exceeds 8 KB (8192 bytes). Only the first 8 KB of the request body are forwarded to WAF by the underlying host service. Valid values: `CONTINUE`, `MATCH`, `NO_MATCH`.

### `cookies` Block

Inspect the cookies in the web request. You can specify the parts of the cookies to inspect and you can narrow the set of cookies to inspect by including or excluding specific keys. This is used to indicate the web request component to inspect, in the [FieldToMatch](https://docs.aws.amazon.com/waf/latest/APIReference/API_FieldToMatch.html) specification.

The `cookies` block supports the following arguments:

* `matchPattern` - (Required) The filter to use to identify the subset of cookies to inspect in a web request. You must specify exactly one setting: either `all`, `includedCookies` or `excludedCookies`. More details: [CookieMatchPattern](https://docs.aws.amazon.com/waf/latest/APIReference/API_CookieMatchPattern.html)
* `matchScope` - (Required) The parts of the cookies to inspect with the rule inspection criteria. If you specify All, AWS WAF inspects both keys and values. Valid values: `ALL`, `KEY`, `VALUE`
* `oversizeHandling` - (Required) What AWS WAF should do if the cookies of the request are larger than AWS WAF can inspect. AWS WAF does not support inspecting the entire contents of request cookies when they exceed 8 KB (8192 bytes) or 200 total cookies. The underlying host service forwards a maximum of 200 cookies and at most 8 KB of cookie contents to AWS WAF. Valid values: `CONTINUE`, `MATCH`, `NO_MATCH`.

### `textTransformation` Block

The `textTransformation` block supports the following arguments:

* `priority` - (Required) Relative processing order for multiple transformations that are defined for a rule statement. AWS WAF processes all transformations, from lowest priority to highest, before inspecting the transformed content.
* `type` - (Required) Transformation to apply, please refer to the Text Transformation [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_TextTransformation.html) for more details.

### `visibilityConfig` Block

The `visibilityConfig` block supports the following arguments:

* `cloudwatchMetricsEnabled` - (Required) Whether the associated resource sends metrics to CloudWatch. For the list of available metrics, see [AWS WAF Metrics](https://docs.aws.amazon.com/waf/latest/developerguide/monitoring-cloudwatch.html#waf-metrics).
* `metricName` - (Required) A friendly name of the CloudWatch metric. The name can contain only alphanumeric characters (A-Z, a-z, 0-9) hyphen(-) and underscore (\_), with length from one to 128 characters. It can't contain whitespace or metric names reserved for AWS WAF, for example `All` and `Default_Action`.
* `sampledRequestsEnabled` - (Required) Whether AWS WAF should store a sampling of the web requests that match the rules. You can view the sampled requests through the AWS WAF console.

### `captchaConfig` Block

The `captchaConfig` block supports the following arguments:

* `immunityTimeProperty` - (Optional) Defines custom immunity time. See [`immunityTimeProperty`](#immunity_time_property-block) below for details.

### `challengeConfig` Block

The `challengeConfig` block supports the following arguments:

* `immunityTimeProperty` - (Optional) Defines custom immunity time. See [`immunityTimeProperty`](#immunity_time_property-block) below for details.

### `immunityTimeProperty` Block

The `immunityTimeProperty` block supports the following arguments:

* `immunityTime` - (Optional) The amount of time, in seconds, that a CAPTCHA or challenge timestamp is considered valid by AWS WAF. The default setting is 300.

### `requestBody` Block

The `requestBody` block supports the following arguments:

* `apiGateway` - (Optional) Customizes the request body that your protected Amazon API Gateway REST APIs forward to AWS WAF for inspection. Applicable only when `scope` is set to `CLOUDFRONT`. See [`apiGateway`](#api_gateway-block) below for details.
* `appRunnerService` - (Optional) Customizes the request body that your protected Amazon App Runner services forward to AWS WAF for inspection. Applicable only when `scope` is set to `REGIONAL`. See [`appRunnerService`](#app_runner_service-block) below for details.
* `cloudfront` - (Optional) Customizes the request body that your protected Amazon CloudFront distributions forward to AWS WAF for inspection. Applicable only when `scope` is set to `REGIONAL`. See [`cloudfront`](#cloudfront-block) below for details.
* `cognitoUserPool` - (Optional) Customizes the request body that your protected Amazon Cognito user pools forward to AWS WAF for inspection. Applicable only when `scope` is set to `REGIONAL`. See [`cognitoUserPool`](#cognito_user_pool-block) below for details.
* `verifiedAccessInstance` - (Optional) Customizes the request body that your protected AWS Verfied Access instances forward to AWS WAF for inspection. Applicable only when `scope` is set to `REGIONAL`. See [`verifiedAccessInstance`](#verified_access_instance-block) below for details.

### `apiGateway` Block

The `apiGateway` block supports the following arguments:

* `defaultSizeInspectionLimit` - (Required) Specifies the maximum size of the web request body component that an associated Amazon API Gateway REST APIs should send to AWS WAF for inspection. This applies to statements in the web ACL that inspect the body or JSON body. Valid values are `KB_16`, `KB_32`, `KB_48` and `KB_64`.

### `appRunnerService` Block

The `appRunnerService` block supports the following arguments:

* `defaultSizeInspectionLimit` - (Required) Specifies the maximum size of the web request body component that an associated Amazon App Runner services should send to AWS WAF for inspection. This applies to statements in the web ACL that inspect the body or JSON body. Valid values are `KB_16`, `KB_32`, `KB_48` and `KB_64`.

### `cloudfront` Block

The `cloudfront` block supports the following arguments:

* `defaultSizeInspectionLimit` - (Required) Specifies the maximum size of the web request body component that an associated Amazon CloudFront distribution should send to AWS WAF for inspection. This applies to statements in the web ACL that inspect the body or JSON body. Valid values are `KB_16`, `KB_32`, `KB_48` and `KB_64`.

### `cognitoUserPool` Block

The `cognitoUserPool` block supports the following arguments:

* `defaultSizeInspectionLimit` - (Required) Specifies the maximum size of the web request body component that an associated Amazon Cognito user pools should send to AWS WAF for inspection. This applies to statements in the web ACL that inspect the body or JSON body. Valid values are `KB_16`, `KB_32`, `KB_48` and `KB_64`.

### `verifiedAccessInstance` Block

The `verifiedAccessInstance` block supports the following arguments:

* `defaultSizeInspectionLimit` - (Required) Specifies the maximum size of the web request body component that an associated AWS Verified Access instances should send to AWS WAF for inspection. This applies to statements in the web ACL that inspect the body or JSON body. Valid values are `KB_16`, `KB_32`, `KB_48` and `KB_64`.

### `customKey` Block

Aggregate the request counts using one or more web request components as the aggregate keys. With this option, you must specify the aggregate keys in the `custom_keys` block. To aggregate on only the IP address or only the forwarded IP address, don't use custom keys. Instead, set the `aggregateKeyType` to `IP` or `FORWARDED_IP`.

The `customKey` block supports the following arguments:

* `cookie` - (Optional) Use the value of a cookie in the request as an aggregate key. See [RateLimit `cookie`](#ratelimit-cookie-block) below for details.
* `forwardedIp` - (Optional) Use the first IP address in an HTTP header as an aggregate key. See [`forwardedIp`](#ratelimit-forwarded_ip-block) below for details.
* `httpMethod` - (Optional) Use the request's HTTP method as an aggregate key. See [RateLimit `httpMethod`](#ratelimit-http_method-block) below for details.
* `header` - (Optional) Use the value of a header in the request as an aggregate key. See [RateLimit `header`](#ratelimit-header-block) below for details.
* `ip` - (Optional) Use the request's originating IP address as an aggregate key. See [`RateLimit ip`](#ratelimit-ip-block) below for details.
* `labelNamespace` - (Optional) Use the specified label namespace as an aggregate key. See [RateLimit `labelNamespace`](#ratelimit-label_namespace-block) below for details.
* `queryArgument` - (Optional) Use the specified query argument as an aggregate key. See [RateLimit `queryArgument`](#ratelimit-query_argument-block) below for details.
* `queryString` - (Optional) Use the request's query string as an aggregate key. See [RateLimit `queryString`](#ratelimit-query_string-block) below for details.
* `uriPath` - (Optional) Use the request's URI path as an aggregate key. See [RateLimit `uriPath`](#ratelimit-uri_path-block) below for details.

### RateLimit `cookie` Block

Use the value of a cookie in the request as an aggregate key. Each distinct value in the cookie contributes to the aggregation instance. If you use a single cookie as your custom key, then each value fully defines an aggregation instance.

The `cookie` block supports the following arguments:

* `name`: The name of the cookie to use.
* `textTransformation`: Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. They are used in rate-based rule statements, to transform request components before using them as custom aggregation keys. Atleast one transformation is required. See [`textTransformation`](#text_transformation-block) above for details.

### RateLimit `forwardedIp` Block

Use the first IP address in an HTTP header as an aggregate key. Each distinct forwarded IP address contributes to the aggregation instance. When you specify an IP or forwarded IP in the custom key settings, you must also specify at least one other key to use. You can aggregate on only the forwarded IP address by specifying `FORWARDED_IP` in your rate-based statement's `aggregateKeyType`. With this option, you must specify the header to use in the rate-based rule's [`forwardedIpConfig`](#forwarded_ip_config-block) block.

The `forwardedIp` block is configured as an empty block `{}`.

### RateLimit `httpMethod` Block

Use the request's HTTP method as an aggregate key. Each distinct HTTP method contributes to the aggregation instance. If you use just the HTTP method as your custom key, then each method fully defines an aggregation instance.

The `httpMethod` block is configured as an empty block `{}`.

### RateLimit `header` Block

Use the value of a header in the request as an aggregate key. Each distinct value in the header contributes to the aggregation instance. If you use a single header as your custom key, then each value fully defines an aggregation instance.

The `header` block supports the following arguments:

* `name`: The name of the header to use.
* `textTransformation`: Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. They are used in rate-based rule statements, to transform request components before using them as custom aggregation keys. Atleast one transformation is required. See [`textTransformation`](#text_transformation-block) above for details.

### RateLimit `ip` Block

Use the request's originating IP address as an aggregate key. Each distinct IP address contributes to the aggregation instance. When you specify an IP or forwarded IP in the custom key settings, you must also specify at least one other key to use. You can aggregate on only the IP address by specifying `IP` in your rate-based statement's `aggregateKeyType`.

The `ip` block is configured as an empty block `{}`.

### RateLimit `labelNamespace` Block

Use the specified label namespace as an aggregate key. Each distinct fully qualified label name that has the specified label namespace contributes to the aggregation instance. If you use just one label namespace as your custom key, then each label name fully defines an aggregation instance. This uses only labels that have been added to the request by rules that are evaluated before this rate-based rule in the web ACL. For information about label namespaces and names, see Label syntax and naming requirements (https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-label-requirements.html) in the WAF Developer Guide.

The `labelNamespace` block supports the following arguments:

* `namespace`: The namespace to use for aggregation

### RateLimit `queryArgument` Block

Use the specified query argument as an aggregate key. Each distinct value for the named query argument contributes to the aggregation instance. If you use a single query argument as your custom key, then each value fully defines an aggregation instance.

The `queryArgument` block supports the following arguments:

* `name`: The name of the query argument to use.
* `textTransformation`: Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. They are used in rate-based rule statements, to transform request components before using them as custom aggregation keys. Atleast one transformation is required. See [`textTransformation`](#text_transformation-block) above for details.

### RateLimit `queryString` Block

Use the request's query string as an aggregate key. Each distinct string contributes to the aggregation instance. If you use just the query string as your custom key, then each string fully defines an aggregation instance.

The `queryString` block supports the following arguments:

* `textTransformation`: Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. They are used in rate-based rule statements, to transform request components before using them as custom aggregation keys. Atleast one transformation is required. See [`textTransformation`](#text_transformation-block) above for details.

### RateLimit `uriPath` Block

Use the request's URI path as an aggregate key. Each distinct URI path contributes to the aggregation instance. If you use just the URI path as your custom key, then each URI path fully defines an aggregation instance.

The `uriPath` block supports the following arguments:

* `textTransformation`: Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection. They are used in rate-based rule statements, to transform request components before using them as custom aggregation keys. Atleast one transformation is required. See [`textTransformation`](#text_transformation-block) above for details.

## Attribute Reference

This resource exports the following attributes in addition to the arguments above:

* `applicationIntegrationUrl` - The URL to use in SDK integrations with managed rule groups.
* `arn` - The ARN of the WAF WebACL.
* `capacity` - Web ACL capacity units (WCUs) currently being used by this web ACL.
* `id` - The ID of the WAF WebACL.
* `tagsAll` - Map of tags assigned to the resource, including those inherited from the provider [`defaultTags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).

## Import

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import WAFv2 Web ACLs using `ID/Name/Scope`. For example:

```typescript
// DO NOT EDIT. Code generated by 'cdktf convert' - Please report bugs at https://cdk.tf/bug
import { Construct } from "constructs";
import { TerraformStack } from "cdktf";
/*
 * Provider bindings are generated by running `cdktf get`.
 * See https://cdk.tf/provider-generation for more details.
 */
import { Wafv2WebAcl } from "./.gen/providers/aws/wafv2-web-acl";
class MyConvertedCode extends TerraformStack {
  constructor(scope: Construct, name: string) {
    super(scope, name);
    Wafv2WebAcl.generateConfigForImport(
      this,
      "example",
      "a1b2c3d4-d5f6-7777-8888-9999aaaabbbbcccc/example/REGIONAL"
    );
  }
}

```

Using `terraform import`, import WAFv2 Web ACLs using `ID/Name/Scope`. For example:

```console
% terraform import aws_wafv2_web_acl.example a1b2c3d4-d5f6-7777-8888-9999aaaabbbbcccc/example/REGIONAL
```

<!-- cache-key: cdktf-0.20.1 input-4d5cc2755c11ee17ed48162c5f3f9e5bc71cb1c30afe0cae4bcadc19cff9f553 -->